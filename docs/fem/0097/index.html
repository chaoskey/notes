<!DOCTYPE html>
<html lang="cn">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="有限元方法（一）【翻译】"><meta property="og:title" content="有限元方法（一）【翻译】" />
<meta property="og:description" content="有限元法解偏微分方程（FEniCS）
有限元法求解牛顿流体（FEniCS）
这两篇笔记仅做入门之用。  为了深入掌握，建议阅读《Automated Solution of Differential Equations by the Finite Element Method》。 为此，我一边学习一边翻译权当笔记。
I.方法论》2.有限元方法（一）
【章节目录】
有限元方法已经成为求解微分方程的通用方法。有限元方法的成功大部分可以归因于它的通用性和优雅性，它允许在一个通用框架内分析和求解来自科学所有领域的各种微分方程。有限元方法成功的另一个因素是公式的灵活性，可以通过选择近似的有限元空间来控制离散化的属性。
在本章中，我们回顾有限元方法，并总结整本书中使用的一些基本概念和符号。
在接下来的章节中，我们将更详细地讨论这些概念，并特别关注有限元方法的实现和自动化，这是FEniCS项目的一部分。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chaoskey.gitee.io/notes/docs/fem/0097/" />
<meta property="article:published_time" content="2020-12-16T16:49:14+08:00" />
<meta property="article:modified_time" content="2020-12-16T16:49:14+08:00" />
<title>有限元方法（一）【翻译】 | 学习笔记</title>
<link rel="icon" href="/notes/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/notes/book.min.3a0afab795624b6557eb098eddc1c880180827e07fdb828f747c01148048289e.css" integrity="sha256-Ogr6t5ViS2VX6wmO3cHIgBgIJ&#43;B/24KPdHwBFIBIKJ4=">


<script defer src="/notes/cn.search.min.ae40ea0b51c8339faa91e6c7185b6b7a562a2c37dc01ce6818eaab312cbe1d25.js" integrity="sha256-rkDqC1HIM5&#43;qkebHGFtrelYqLDfcAc5oGOqrMSy&#43;HSU="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/notes"><img src="/notes/logo.png" alt="Logo" /><span>学习笔记</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="搜索" aria-label="搜索" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>









  










    
    



<ul>
<li><a href="/notes/posts/"><strong>站点维护记录</strong></a></li>
<li><a href="/notes/docs/fem/"><strong>有限元法自动求解微分方程</strong></a>
<ul>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E6%96%B9%E6%B3%95">第二章 有限元方法</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%B8%B8%E8%A7%81%E6%9C%89%E9%99%90%E5%85%83">第三章 常见有限元</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E6%9E%84%E9%80%A0%E9%80%9A%E7%94%A8%E5%8F%82%E8%80%83%E5%8D%95%E5%85%83">第四章 构造通用参考单元</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E4%BA%94%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E5%8F%98%E5%88%86%E5%BD%A2%E5%BC%8F">第五章 有限元变分形式</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%85%AD%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E7%BB%84%E8%A3%85">第六章 有限元组装</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E4%B8%83%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E5%8F%98%E5%88%86%E5%BD%A2%E5%BC%8F%E7%9A%84%E6%AD%A3%E4%BA%A4%E8%A1%A8%E7%A4%BA">第七章 有限元变分形式的正交表示</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%85%AB%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E5%8F%98%E5%88%86%E5%BD%A2%E5%BC%8F%E7%9A%84%E5%BC%A0%E9%87%8F%E8%A1%A8%E7%A4%BA">第八章 有限元变分形式的张量表示</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E4%B9%9D%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E7%9F%A9%E9%98%B5%E8%AE%A1%E7%AE%97%E7%9A%84%E7%A6%BB%E6%95%A3%E4%BC%98%E5%8C%96">第九章 有限元矩阵计算的离散优化</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%8D%81%E7%AB%A0-dolfincpython%E6%9C%89%E9%99%90%E5%85%83%E5%BA%93">第十章 DOLFIN：C++/Python有限元库</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%8D%81%E4%B8%83%E7%AB%A0-ufl%E6%9C%89%E9%99%90%E5%85%83%E5%BD%A2%E5%BC%8F%E8%AF%AD%E8%A8%80">第十七章 UFL：有限元形式语言</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%8D%81%E5%85%AB%E7%AB%A0-unicorn%E7%BB%9F%E4%B8%80%E7%9A%84%E8%BF%9E%E7%BB%AD%E4%BB%8B%E8%B4%A8%E5%8A%9B%E5%AD%A6%E6%B1%82%E8%A7%A3%E5%99%A8">第十八章 Unicorn：统一的连续介质力学求解器</a></li>
</ul>
</li>
<li><a href="/notes/docs/julia/"><strong>基于Julia科学计算</strong></a></li>
<li><a href="/notes/docs/theophy/"><strong>理论物理学习笔记</strong></a></li>
<li><a href="/notes/docs/diffgeo/"><strong>微分几何笔记</strong></a></li>
<li><a href="/notes/docs/mlapp/"><strong>机器学习：概率视角</strong></a></li>
<li><a href="/notes/docs/apm/"><strong>主动投资组合管理</strong></a></li>
</ul>












</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/notes/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>有限元方法（一）【翻译】</strong>

  <label for="toc-control">
    <img src="/notes/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#i方法论2有限元方法一">I.方法论》2.有限元方法（一）</a>
      <ul>
        <li><a href="#21-一个简单的模型问题">2·1 一个简单的模型问题</a></li>
        <li><a href="#22-有限元离散化">2·2 有限元离散化</a>
          <ul>
            <li><a href="#221-泊松方程离散化">2·2·1 泊松方程离散化</a></li>
            <li><a href="#222-一阶方程组离散化">2·2·2 一阶方程组离散化</a></li>
          </ul>
        </li>
        <li><a href="#23-有限元抽象形式">2·3 有限元抽象形式</a>
          <ul>
            <li><a href="#231-线性问题">2·3·1 线性问题</a></li>
            <li><a href="#232-非线性问题">2·3·2 非线性问题</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      

<nav class="post-pagination">
  
  <a class="newer-posts" href="https://chaoskey.gitee.io/notes/docs/fem/0098/">
    下一页<br>有限元方法（二）【翻译】
  </a>
  
  
  <a class="older-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0096/">
      上一页<br>有限元法求解牛顿流体（FEniCS）
  </a>
  
</nav>

<hr>

<article class="markdown">
  <h1>
    <a href="/notes/docs/fem/0097/">有限元方法（一）【翻译】</a>
  </h1>
  

<div>

  <h5>2020-12-16</h5>


<div>

  
    |
    
      <a href="/notes/categories/%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97">科学计算</a>
      
    |
  

  
    |
    
      <a href="/notes/tags/FEniCS">FEniCS</a>
      , 
      <a href="/notes/tags/%E6%9C%89%E9%99%90%E5%85%83%E6%B3%95">有限元法</a>
      , 
      <a href="/notes/tags/%E5%81%8F%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B">偏微分方程</a>
      
    |
  




    <a href="https://gitee.com/chaoskey/notes/blob/master/content/docs/fem/0097.md#blob-comment" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Comment" />
      评论
    </a>


</div>


</div>

<p><a href="/notes/docs/julia/0094/">有限元法解偏微分方程（FEniCS）</a></p>
<p><a href="/notes/docs/julia/0096/">有限元法求解牛顿流体（FEniCS）</a></p>
<p>这两篇笔记仅做入门之用。  为了深入掌握，建议阅读《Automated Solution of Differential Equations by the Finite Element Method》。 为此，我一边学习一边翻译权当笔记。</p>
<h1 id="i方法论2有限元方法一">I.方法论》2.有限元方法（一）</h1>
<p>【<a href="/notes/docs/fem/#%e7%ac%ac%e4%ba%8c%e7%ab%a0-%e6%9c%89%e9%99%90%e5%85%83%e6%96%b9%e6%b3%95">章节目录</a>】</p>
<p>有限元方法已经成为求解微分方程的通用方法。有限元方法的成功大部分可以归因于它的通用性和优雅性，它允许在一个通用框架内分析和求解来自科学所有领域的各种微分方程。有限元方法成功的另一个因素是公式的灵活性，可以通过选择近似的有限元空间来控制离散化的属性。</p>
<p>在本章中，我们回顾有限元方法，并总结整本书中使用的一些基本概念和符号。</p>
<p>在接下来的章节中，我们将更详细地讨论这些概念，并特别关注有限元方法的实现和自动化，这是FEniCS项目的一部分。</p>
<h2 id="21-一个简单的模型问题">2·1 一个简单的模型问题</h2>
<p>1813年，西蒙·丹尼斯·泊松（SiméonDenis Poisson）在《哲学公报》上发表了他的著名公式，作为对皮埃尔-西蒙·拉普拉斯(Pierre-Simon Laplace)早些时候发表的公式的修正。  泊松方程是一个二阶偏微分方程，在域
  
    

    <link rel="stylesheet" href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    
    
    <script defer src="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    
    
    <script defer src="https://cdn.bootcss.com/KaTeX/0.11.1/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body,
                {delimiters: [{left: '$$\n', right: '\n$$', display: true}, {left: '$$', right: '$$', display: false}, 
                              {left: '\\[', right: '\\]', display: true}, {left: '\\(', right: '\\)', display: false}]});"></script>
    
  




<span class="katex">
  \(\Omega\subset \mathbb{R}^d\)
</span>
上，未知场


<span class="katex">
  \(u = u(x)\)
</span>
被<code>负拉普拉斯算符</code>作用后（


<span class="katex">
  \(-\Delta u\)
</span>
）等于给定函数


<span class="katex">
  \(f = f(x)\)
</span>
，并且在


<span class="katex">
  \(\Omega\)
</span>
的边界


<span class="katex">
  \(\partial \Omega\)
</span>
上，u被一组边界条件集约束：</p>



<span class="katex">
  \[
\begin{aligned}-\Delta u = f & \qquad \mathrm{in} \ \Omega \\ u = u_0 & \qquad \mathrm{on} \ \Gamma_D \subset  \partial \Omega \\ -\partial_n u = g & \qquad \mathrm{on} \ \Gamma_N \subset  \partial \Omega \end{aligned} \tag{2.1}
\]
</span>

<p>Dirichlet边界条件


<span class="katex">
  \(u=u_0\)
</span>
表示u在边界子集


<span class="katex">
  \(\Gamma_D\)
</span>
上的约束值，而Neumann边界条件


<span class="katex">
  \(-\partial_n u = g\)
</span>
则表示u在其余边界


<span class="katex">
  \(\Gamma_N=\partial \Omega - \Gamma_D\)
</span>
上的（负的）法向导数的约束值。泊松方程是引力，电磁，热传导，流体流动和许多其他物理过程的简单模型。在许多更复杂的物理模型中，它也作为基本构建块出现，包括Navier-Stokes方程，我们将在第20、21、22、23、24、25、28和29章中回头讨论。</p>
<p>为了推导泊松方程（2.1），我们可以考虑区域


<span class="katex">
  \(\Omega\)
</span>
中，热源分布为


<span class="katex">
  \(f\)
</span>
，关于温度u的模型。 令


<span class="katex">
  \(\sigma=\sigma(x)\)
</span>
表示热通量，根据能量守恒，对任何测试体


<span class="katex">
  \(\omega \subset \Omega\)
</span>
，从其边界


<span class="katex">
  \(\partial \omega\)
</span>
流出的能量必须和热源


<span class="katex">
  \(f\)
</span>
发出的能量平衡：</p>



<span class="katex">
  \[
\int_{\partial\omega}{\sigma \cdot n ds} = \int_\omega{fdx}  \tag{2.2}
\]
</span>

<p>左边的面积分可改写成体积分，于是有：</p>



<span class="katex">
  \[
\int_\omega{\nabla \cdot \sigma ds} = \int_\omega{fdx}  \tag{2.3}
\]
</span>

<p>由于上式对于任意测试体


<span class="katex">
  \(\omega \subset \Omega\)
</span>
均成立，因此在整个


<span class="katex">
  \(\Omega\)
</span>
中, 


<span class="katex">
  \(\nabla \cdot \sigma = f\)
</span>
（并且在


<span class="katex">
  \(\sigma\)
</span>
和


<span class="katex">
  \(f\)
</span>
上服从适当的正规性假设）。如果现在我们又假设热通量


<span class="katex">
  \(\sigma\)
</span>
与温度


<span class="katex">
  \(u\)
</span>
的负梯度成比例（傅立叶定律）:</p>



<span class="katex">
  \[
\sigma = -\kappa \nabla u  \tag{2.4}
\]
</span>

<p>于是得到下面这个方程组：</p>



<span class="katex">
  \[
\begin{aligned}\nabla \cdot \sigma = f & \qquad \mathrm{in} \ \Omega \\ \sigma + \nabla u = 0  & \qquad \mathrm{in} \  \Omega\end{aligned}  \tag{2.5}
\]
</span>

<p>我们假设热传导系数为


<span class="katex">
  \(\kappa = 1\)
</span>
。 如图2.1下所示。 将第一个方程式中的


<span class="katex">
  \(\sigma\)
</span>
替换为


<span class="katex">
  \(-\nabla u\)
</span>
，我们得到前面的泊松方程（2.1）。反之，通过对泊松方程（2.1）引入


<span class="katex">
  \(\sigma =-\nabla u\)
</span>
作为辅助变量，也可以得出上面这个一阶方程组（2.5）。 我们还注意到泊松方程（2.1）的两个边界条件：Dirichlet和Neumann边界条件，分别对应于温度和热通量的约束值。</p>
<p><img src="/notes/images/0178.jpg" alt="0178.jpg"></p>
<center>图2.1: 泊松方程是任意测试体积


<span class="katex">
  \(\omega \subset \Omega\)
</span>
中能量平衡的简单结果。</center>
<h2 id="22-有限元离散化">2·2 有限元离散化</h2>
<h3 id="221-泊松方程离散化">2·2·1 泊松方程离散化</h3>
<p>为了用有限元方法离散化泊松方程（2.1），我们首先乘以测试函数


<span class="katex">
  \(v\)
</span>
，然后通过分部积分得：</p>



<span class="katex">
  \[
\int_\Omega{\nabla u \cdot \nabla v dx} - \int_{\partial \Omega}{\partial_n u v ds} = \int_\Omega{f v dx}  \tag{2.6}
\]
</span>

<p>让测试函数(test function)


<span class="katex">
  \(v\)
</span>
在Dirichlet边界


<span class="katex">
  \(\Gamma_D\)
</span>
上消失（解u在该边界上已知），我们得到以下经典的变分问题：寻求


<span class="katex">
  \(u \in V\)
</span>
，满足：</p>



<span class="katex">
  \[
\int_\Omega{\nabla u \cdot \nabla v dx} = \int_\Omega{f v dx} - \int_{\Gamma_N}{g v ds} \qquad \forall v \in \hat{V}  \tag{2.7}
\]
</span>

<p>测试空间(test space)


<span class="katex">
  \(\hat{V}\)
</span>
被定义为：</p>



<span class="katex">
  \[
\hat{V} = \left\{v \in H^1(\Omega) : v=0 \ \mathrm{on} \ \Gamma_D \right\}  \tag{2.8}
\]
</span>

<p>试探空间(trial space)


<span class="katex">
  \(V\)
</span>
, 则是测试空间的Dirichlet条件平移后得到的空间：</p>



<span class="katex">
  \[
V = \left\{u \in H^1(\Omega) : u=u_0 \ \mathrm{on} \ \Gamma_D \right\}  \tag{2.9}
\]
</span>

<p>现在，我们可以通过将变分问题（2.7）限制在这对离散空间中来离散化泊松方程：寻求


<span class="katex">
  \(u_h \in V_h \subset V\)
</span>
 满足：</p>



<span class="katex">
  \[
\int_\Omega{\nabla u_h \cdot \nabla v dx} = \int_\Omega{f v dx} - \int_{\Gamma_N}{g v ds} \qquad \forall v \in \hat{V}_h \subset \hat{V}  \tag{2.10}
\]
</span>

<p>我们在这里注意到，在


<span class="katex">
  \(\Gamma_D\)
</span>
上的Dirichlet条件


<span class="katex">
  \(u = u_0\)
</span>
直接进入试探空间


<span class="katex">
  \(V_h\)
</span>
的定义（这是一个基本边界条件），而在


<span class="katex">
  \(\Gamma_N\)
</span>
上的Neumann条件


<span class="katex">
  \(−\partial_n u = g\)
</span>
则进入了变分问题（它是自然边界条件）。</p>
<p>为了求解这个离散的变分问题（2.10），我们必须构造合适的一对离散试探空间和测试空间


<span class="katex">
  \(V_h\)
</span>
和


<span class="katex">
  \(\hat{V}_h\)
</span>
。我们后面将回到这个问题，在此之前，现在我们假设


<span class="katex">
  \(V_h\)
</span>
有一个基


<span class="katex">
  \(\{\phi_j\}^N_{j=1}\)
</span>
，


<span class="katex">
  \(\hat{V}\)
</span>
也有一个基


<span class="katex">
  \(\{\hat{\phi}_j\}^N_{j=1}\)
</span>
。在此，N表示空间


<span class="katex">
  \(V_h\)
</span>
和


<span class="katex">
  \(\hat{V}_h\)
</span>
的尺寸。然后，我们可以将


<span class="katex">
  \(u_h\)
</span>
用试探空间的基函数来展开：</p>



<span class="katex">
  \[
u_h(x) = \sum_{j=1}^N{U_j \phi_j(x)}  \tag{2.11}
\]
</span>

<p>其中，


<span class="katex">
  \(U\in \mathbb{R}^N\)
</span>
是要被计算的作为自由度的向量。将其带入离散化的变分问题中，并用离散测试空间


<span class="katex">
  \(\hat{V}_h\)
</span>
的基函数来充当测试函数


<span class="katex">
  \(v\)
</span>
，于是：</p>



<span class="katex">
  \[
\begin{aligned}\sum_{j=1}^N{U_j \int_\Omega{\nabla \phi_j \cdot \nabla  \hat{\phi}_i dx}} = \int_\Omega{f \hat{\phi}_i dx} - \int_{\Gamma_N}{g \hat{\phi}_i ds}  \\  i = 1,2,\dots,N \end{aligned}  \tag{2.12}
\]
</span>

<p>因此，我们可以通过求解这个线性方程组来计算出有限元解


<span class="katex">
  \(u_h = \sum^N_{j=1}{U_j \phi_j}\)
</span>
:</p>



<span class="katex">
  \[
A U = b  \tag{2.13}
\]
</span>

<p>其中：</p>



<span class="katex">
  \[
A_{ij}=\int_\Omega{\nabla \phi_j \cdot \nabla  \hat{\phi}_i dx} \\ b_i = \int_\Omega{f \hat{\phi}_i dx} - \int_{\Gamma_N}{g \hat{\phi}_i ds}  \tag{2.14}
\]
</span>

<h3 id="222-一阶方程组离散化">2·2·2 一阶方程组离散化</h3>
<p>我们可以类似地离散一个一阶方程组（2.5）： 将第一个一阶方程乘以一个测试函数v，并将第二个一阶方程乘以另一个测试函数τ，然后进行积分再相加合并，得到</p>



<span class="katex">
  \[
\begin{aligned}\int_\Omega{\left[(\nabla \cdot \sigma) v  + \sigma \cdot \tau - u \nabla \cdot \tau\right]dx}+ \int_{\partial \Omega}{u \tau \cdot n ds} = \int_\Omega{ f v dx}  \\ \forall(v,\tau)\in \hat{V} \end{aligned} \tag{2.15}
\]
</span>

<p>在Neumann边界


<span class="katex">
  \(\Gamma_N\)
</span>
上已知单位通量


<span class="katex">
  \(\sigma \cdot n = g\)
</span>
，因此我们取


<span class="katex">
  \(\tau \cdot n = 0\)
</span>
。 将u的值带入到Dirichlet边界


<span class="katex">
  \(\Gamma_D\)
</span>
上，我们得出以下变分问题：寻求


<span class="katex">
  \((u,\sigma) \in V\)
</span>
，满足</p>



<span class="katex">
  \[
\begin{aligned}\int_\Omega{\left[(\nabla \cdot \sigma) v  + \sigma \cdot \tau - u \nabla \cdot \tau\right]dx} = \int_\Omega{ f v dx} - \int_{\Gamma_D}{u_0 \tau \cdot n ds} \\ \forall (v,\tau)\in \hat{V} \end{aligned} \tag{2.16}
\]
</span>

<p>试探空间和测试空间的合适选择是</p>



<span class="katex">
  \[
\begin{aligned} V=\left\{ (v,\tau) : v\in L^2(\Omega), \tau \in H(\mathrm{div},\Omega), \tau \cdot n = g \ \mathrm{on} \ \Gamma_N \right\} \\ \hat{V}=\left\{ (v,\tau) : v\in L^2(\Omega), \tau \in H(\mathrm{div},\Omega), \tau \cdot n = 0 \ \mathrm{on} \ \Gamma_N \right\}  \end{aligned}  \tag{2.17}
\]
</span>

<p>请注意，这个变分问题（2.16）与前面的变分问题（2.7）的不同之处在于，


<span class="katex">
  \(\Gamma_D\)
</span>
上的Dirichlet条件


<span class="katex">
  \(u = u_0\)
</span>
进入了变分公式（现在是自然边界条件），而Neumann条件


<span class="katex">
  \(\sigma \cdot n = g\)
</span>
则在


<span class="katex">
  \(\Gamma_N\)
</span>
上进入试探空间V的定义（现在是基本边界条件）。</p>
<p>同样，我们将变分问题限制在一对离散的试探空间和测试空间


<span class="katex">
  \(V_h \subset V\)
</span>
和


<span class="katex">
  \(\hat{V}_h\subset \hat{V}\)
</span>
上，并有限元解形如：</p>



<span class="katex">
  \[
(u_h,\sigma_h) = \sum^N_{j=1}{U_j(\phi_j,\psi_j)}  \tag{2.18}
\]
</span>

<p>其中，


<span class="katex">
  \(\left\{(\phi_j,\psi_j)\right\}^N_{j=1}\)
</span>
是试探空间


<span class="katex">
  \(V_h\)
</span>
的基底。 通常，


<span class="katex">
  \(\phi_j\)
</span>
或


<span class="katex">
  \(\psi_j\)
</span>
都将消失，因此这个基底实际上是


<span class="katex">
  \(L^2\)
</span>
空间基数和


<span class="katex">
  \(H(\mathrm{div})\)
</span>
空间基数的张量积。因此，我们通过求解线性方程组


<span class="katex">
  \(A U = b\)
</span>
来获得自由度为


<span class="katex">
  \(U \in \mathbb{R}^N\)
</span>
的线性系统</p>



<span class="katex">
  \[
A_{ij}=\int_\Omega{\left[(\nabla \cdot \psi_j)  \hat{\phi}_i  + \psi_j \cdot \hat{\psi}_i - \phi_j \nabla \cdot \hat{\psi}_i\right]dx} \\ b_i = \int_\Omega{f \hat{\phi}_i dx} - \int_{\Gamma_D}{u_0 \hat{\psi}_i \cdot n ds}  \tag{2.19}
\]
</span>

<p>这种有限元离散化（2.19）就是混合方法（<code>mixed method</code>）的一个例子。这种表述需要很小心地为各种不同的函数空间选择兼容的方法，比如这里的


<span class="katex">
  \(L^2\)
</span>
和


<span class="katex">
  \(H(\mathrm{div})\)
</span>
。稳定的离散化必须满足所谓的<code>inf-sup</code>或<code>Ladyzhenskaya-Babuška-Brezzi</code>（LBB）条件。该理论解释了为什么与标准方法相比，混合方法中的许多有限元空间显得更复杂。后面的第3章中，我们将给出了这种有限元空间的几个例子。</p>
<h2 id="23-有限元抽象形式">2·3 有限元抽象形式</h2>
<h3 id="231-线性问题">2·3·1 线性问题</h3>
<p>我们在上面看到，泊松方程（2.1）或（2.5）的有限元解可以通过将有限维（连续）变分问题限制为有限维（离散）变分问题并通过求解线性方程组来获得。</p>
<p>为了对此进行形式化，我们考虑以下规范形式编写的一般线性变分问题：寻求


<span class="katex">
  \(u \in V\)
</span>
满足</p>



<span class="katex">
  \[
a(u,v) = L(v)  \qquad \forall v \in \hat{V} \tag{2.20}
\]
</span>

<p>其中


<span class="katex">
  \(V\)
</span>
是试探空间(trial space)，


<span class="katex">
  \(\hat{V}\)
</span>
是测试空间(test space)。因此，我们用双线性形式


<span class="katex">
  \(a\)
</span>
和线性形式（泛函）


<span class="katex">
  \(L\)
</span>
表示变分问题：</p>



<span class="katex">
  \[
a: V \times \hat{V} \to \mathbb{R} \\ L: \hat{V} \to \mathbb{R}  \tag{2.21}
\]
</span>

<p>和前面一样，我们通过限制一对离散的试探空间和测试空间来离散化这个形式的变分问题（2.20）：寻求


<span class="katex">
  \(u_h \in V_h \subset V\)
</span>
满足</p>



<span class="katex">
  \[
a(u_h,v) = L(v) \qquad \forall v \in \hat{V}_h \subset \hat{V}  \tag{2.22}
\]
</span>

<p>为了解决这种形式化的离散变分问题（2.22），我们将


<span class="katex">
  \(u_h\)
</span>
展开为：</p>



<span class="katex">
  \[
u_h = \sum^N_{j=1}{U_j \phi_j}  \tag{2.23}
\]
</span>

<p>取


<span class="katex">
  \(v = \hat{\phi}_i,  \ i = 1,2,\dots, N\)
</span>
。和前面一样，


<span class="katex">
  \(\{\phi_j\}^N_{j=1}\)
</span>
是离散试探空间


<span class="katex">
  \(V_h\)
</span>
的基底，


<span class="katex">
  \(\{\hat{\phi}_i\}^N_{i=1}\)
</span>
则是离散测试空间


<span class="katex">
  \(\hat{V}_h\)
</span>
的基底。它满足：</p>



<span class="katex">
  \[
\sum^N_{j=1}{U_j a(\phi_j,\hat{\phi}_i)} = L(\hat{\phi}_i),\qquad i = 1,2,\dots, N  \tag{2.24}
\]
</span>

<p>然后可以通过求解线性方程组


<span class="katex">
  \(A U = b\)
</span>
来计算自由度


<span class="katex">
  \(U \in \mathbb{R}^N\)
</span>
的线性系统，其中</p>



<span class="katex">
  \[
A_{ij} = a(\phi_j, \hat{\phi}_i), \qquad i,j = 1,2,\dots,N \\ b_i = L(\hat{\phi}_i) \qquad i = 1,2,\dots,N  \tag{2.25}
\]
</span>

<h3 id="232-非线性问题">2·3·2 非线性问题</h3>
<p>我们还考虑以下规范形式编写的非线性变分问题：寻求


<span class="katex">
  \(u \in V\)
</span>
满足</p>



<span class="katex">
  \[
F(u; v) = 0, \qquad  \forall v \in \hat{V}  \tag{2.26} 
\]
</span>

<p>现在


<span class="katex">
  \(F:V \times \hat{V} \to \mathbb{R}\)
</span>
是一个半线性形式，分号后的参数中是线性的。和前面一样，我们通过限制一对离散的试探和测试空间来离散化此变分问题（2.26）：寻找


<span class="katex">
  \(u_h \in V_h \subset V\)
</span>
满足</p>



<span class="katex">
  \[
F(u_h; v) = 0, \qquad  \forall v \in \hat{V}_h \subset \hat{V}  \tag{2.27}
\]
</span>

<p>然后可以通过求解非线性方程组来计算有限元解


<span class="katex">
  \(u_h = \sum^N_{j=1}{U_j \phi_j}\)
</span>
：</p>



<span class="katex">
  \[
b(U) = 0  \tag{2.28}
\]
</span>

<p>其中


<span class="katex">
  \(b:\mathbb{R}^N \to \mathbb{R}^N\)
</span>
和</p>



<span class="katex">
  \[
b_i(U) = F(u_h; \hat{\phi}_i), \qquad i=1,2,\dots,N  \tag{2.29}
\]
</span>

<p>为了用牛顿法或牛顿法的某些变体求解这种非线性方程组（2.28），我们要计算雅可比行列式A = b'。我们注意到，如果半线性形式


<span class="katex">
  \(F\)
</span>
对


<span class="katex">
  \(u\)
</span>
是可微的，则雅可比矩阵A的各项由下式给出：</p>



<span class="katex">
  \[
\begin{aligned}A_{ij}(u_h) &= \frac{\partial b_i(U)}{\partial U_j} =  \frac{\partial}{\partial U_j}  F(u_h; \hat{\phi}_i) \\ &=  F'(u_h; \hat{\phi}_i) \frac{\partial u_h}{\partial U_j} =  F'(u_h; \hat{\phi}_i) \phi_j  \overset{\Delta}{=}   F'(u_h; \phi_j,\hat{\phi}_i) \end{aligned}  \tag{2.30}
\]
</span>

<p>在每次牛顿迭代中，我们必须计算（组装）矩阵A和向量b，并通过以下方式更新解向量U:</p>



<span class="katex">
  \[
U^{k+1} = U^k - \delta U^k ,\qquad k = 0,1,\dots  \tag{2.31}
\]
</span>

<p>其中，


<span class="katex">
  \(\delta U^k\)
</span>
是下面这个线性方程组的解：</p>



<span class="katex">
  \[
A(u^k_h) \delta U^k = b(u^k_h)  \tag{2.32}
\]
</span>

<p>我们注意到，对于每个固定的


<span class="katex">
  \(u_h\)
</span>
，


<span class="katex">
  \(a = F'(u_h; \cdot, \cdot）\)
</span>
是双线性形式，而


<span class="katex">
  \(L=F(u_h; \cdot)\)
</span>
是线性形式。因此，在每次牛顿迭代中，我们都是求解标准形式的线性变分问题（2.20）：寻求


<span class="katex">
  \(\delta u \in V_{h,0}\)
</span>
满足</p>



<span class="katex">
  \[
F'(u_h; \delta u, v) = F(u_h; v) ,\qquad \forall v\in \hat{V}_h   \tag{2.33}
\]
</span>

<p>其中，


<span class="katex">
  \(V_{h,0} = \{v - w : v, w \in  V_h\}\)
</span>
。 正如上一小节2.3.1的离散化（2.33）一样，我们重新找到了一个线性方程组（2.32）。</p>
<p><strong>例子2.1 (非线性泊松方程)</strong> 例如，考虑以下非线性泊松方程：</p>



<span class="katex">
  \[
\begin{aligned}-\nabla \cdot ( (1+u) \nabla u )= f & \qquad \mathrm{in} \ \Omega \\ u = 0 & \qquad \mathrm{on} \ \partial \Omega  \end{aligned}  \tag{2.34}
\]
</span>

<p>在（2.34）两边乘上测试函数


<span class="katex">
  \(v\)
</span>
, 并且进行分部积分得到：</p>



<span class="katex">
  \[
\int_\Omega{((1+u)\nabla u)\cdot \nabla v dx} = \int_{\partial \Omega}{f v dx}   \tag{2.35}
\]
</span>

<p>这是非线性变分问题（2.26），其中:</p>



<span class="katex">
  \[
F(u; v) = \int_\Omega{((1+u)\nabla u)\cdot \nabla v dx} - \int_{\partial \Omega}{f v dx}   \tag{2.36}
\]
</span>

<p>对半线性形式


<span class="katex">
  \(F(u; v)\)
</span>
进行关于


<span class="katex">
  \(u=u_h\)
</span>
的线性化，我们得到</p>



<span class="katex">
  \[
F'(u_h; \delta u, v) = \int_\Omega{(\delta u\nabla u)\cdot \nabla v dx}  + \int_\Omega{((1+u)\nabla \delta u)\cdot \nabla v dx}   \tag{2.37}
\]
</span>

<p>因此，我们可以通过以下方式计算雅可比矩阵


<span class="katex">
  \(A(u_h)\)
</span>
：</p>



<span class="katex">
  \[
\begin{aligned} A_{ij}(u_h) &= F'(u_h; \phi_j, \hat{\phi}_i) \\  &= \int_\Omega{(\phi_j \nabla u)\cdot \nabla \hat{\phi}_i dx}  + \int_\Omega{((1+u)\nabla \phi_j)\cdot \nabla \hat{\phi}_i dx}  \end{aligned} \tag{2.38}
\]
</span>

<p>【<a href="/notes/docs/fem/#%e7%ac%ac%e4%ba%8c%e7%ab%a0-%e6%9c%89%e9%99%90%e5%85%83%e6%96%b9%e6%b3%95">章节目录</a>】</p></article>

<hr>

<nav class="post-pagination">
  
  <a class="newer-posts" href="https://chaoskey.gitee.io/notes/docs/fem/0098/">
    下一页<br>有限元方法（二）【翻译】
  </a>
  
  
  
  <a class="older-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0096/">
      上一页<br>有限元法求解牛顿流体（FEniCS）
  </a>
  
</nav>

 

      <footer class="book-footer">
        
  <div class="flex justify-between">





  <div>
    <a class="flex align-center" href="https://gitee.com/chaoskey/notes/blob/master/content/docs/fem/0097.md#blob-comment" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Comment" />
      <span>评论</span>
    </a>
  </div>
  
  
  <div>
    <a class="flex align-center" href="https://gitee.com/-/ide/project/chaoskey/notes/edit/master/-/content/docs/fem/0097.md" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>编辑本页</span>
    </a>
  </div>

</div>

 
        
  
  <div class="book-comments">

</div>
  
  
      </footer>
      
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#i方法论2有限元方法一">I.方法论》2.有限元方法（一）</a>
      <ul>
        <li><a href="#21-一个简单的模型问题">2·1 一个简单的模型问题</a></li>
        <li><a href="#22-有限元离散化">2·2 有限元离散化</a>
          <ul>
            <li><a href="#221-泊松方程离散化">2·2·1 泊松方程离散化</a></li>
            <li><a href="#222-一阶方程组离散化">2·2·2 一阶方程组离散化</a></li>
          </ul>
        </li>
        <li><a href="#23-有限元抽象形式">2·3 有限元抽象形式</a>
          <ul>
            <li><a href="#231-线性问题">2·3·1 线性问题</a></li>
            <li><a href="#232-非线性问题">2·3·2 非线性问题</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












