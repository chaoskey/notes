<!DOCTYPE html>
<html lang="cn">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Unicorn：统一的连续介质力学求解器（下）【翻译】"><meta property="og:title" content="Unicorn：统一的连续介质力学求解器（下）【翻译】" />
<meta property="og:description" content="II.实现》18.Unicorn：统一的连续介质力学求解器（下）
【章节目录】
18·5 解决连续介质力学问题
在本节中，我们介绍一些使用Unicorn计算的示例。 第一个例子是没有自适应性的流固耦合问题，我们讨论了几何和子域的建模，系数（形式中使用的函数），主程序的参数和规范（运行求解器的接口）。 接下来，我们给出一个用自适应性解决湍流纯流体问题的示例，其中我们涵盖了对偶问题的数据建模，自适应回路，并指定了用于建模湍流边界层的滑移/摩擦边界条件。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chaoskey.gitee.io/notes/docs/fem/0126/" />
<meta property="article:published_time" content="2021-02-21T11:24:41+08:00" />
<meta property="article:modified_time" content="2021-02-21T11:24:41+08:00" />
<title>Unicorn：统一的连续介质力学求解器（下）【翻译】 | 学习笔记</title>
<link rel="icon" href="/notes/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/notes/book.min.3a0afab795624b6557eb098eddc1c880180827e07fdb828f747c01148048289e.css" integrity="sha256-Ogr6t5ViS2VX6wmO3cHIgBgIJ&#43;B/24KPdHwBFIBIKJ4=">


<script defer src="/notes/cn.search.min.ae40ea0b51c8339faa91e6c7185b6b7a562a2c37dc01ce6818eaab312cbe1d25.js" integrity="sha256-rkDqC1HIM5&#43;qkebHGFtrelYqLDfcAc5oGOqrMSy&#43;HSU="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/notes"><img src="/notes/logo.png" alt="Logo" /><span>学习笔记</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="搜索" aria-label="搜索" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>









  










    
    



<ul>
<li><a href="/notes/posts/"><strong>站点维护记录</strong></a></li>
<li><a href="/notes/docs/fem/"><strong>有限元法自动求解微分方程</strong></a>
<ul>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E6%96%B9%E6%B3%95">第二章 有限元方法</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E4%B8%89%E7%AB%A0-%E5%B8%B8%E8%A7%81%E6%9C%89%E9%99%90%E5%85%83">第三章 常见有限元</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E6%9E%84%E9%80%A0%E9%80%9A%E7%94%A8%E5%8F%82%E8%80%83%E5%8D%95%E5%85%83">第四章 构造通用参考单元</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E4%BA%94%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E5%8F%98%E5%88%86%E5%BD%A2%E5%BC%8F">第五章 有限元变分形式</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%85%AD%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E7%BB%84%E8%A3%85">第六章 有限元组装</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E4%B8%83%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E5%8F%98%E5%88%86%E5%BD%A2%E5%BC%8F%E7%9A%84%E6%AD%A3%E4%BA%A4%E8%A1%A8%E7%A4%BA">第七章 有限元变分形式的正交表示</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%85%AB%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E5%8F%98%E5%88%86%E5%BD%A2%E5%BC%8F%E7%9A%84%E5%BC%A0%E9%87%8F%E8%A1%A8%E7%A4%BA">第八章 有限元变分形式的张量表示</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E4%B9%9D%E7%AB%A0-%E6%9C%89%E9%99%90%E5%85%83%E7%9F%A9%E9%98%B5%E8%AE%A1%E7%AE%97%E7%9A%84%E7%A6%BB%E6%95%A3%E4%BC%98%E5%8C%96">第九章 有限元矩阵计算的离散优化</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%8D%81%E7%AB%A0-dolfincpython%E6%9C%89%E9%99%90%E5%85%83%E5%BA%93">第十章 DOLFIN：C++/Python有限元库</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%8D%81%E4%B8%83%E7%AB%A0-ufl%E6%9C%89%E9%99%90%E5%85%83%E5%BD%A2%E5%BC%8F%E8%AF%AD%E8%A8%80">第十七章 UFL：有限元形式语言</a></li>
<li><a href="/notes/docs/fem/#%E7%AC%AC%E5%8D%81%E5%85%AB%E7%AB%A0-unicorn%E7%BB%9F%E4%B8%80%E7%9A%84%E8%BF%9E%E7%BB%AD%E4%BB%8B%E8%B4%A8%E5%8A%9B%E5%AD%A6%E6%B1%82%E8%A7%A3%E5%99%A8">第十八章 Unicorn：统一的连续介质力学求解器</a></li>
</ul>
</li>
<li><a href="/notes/docs/julia/"><strong>基于Julia科学计算</strong></a></li>
<li><a href="/notes/docs/theophy/"><strong>理论物理学习笔记</strong></a></li>
<li><a href="/notes/docs/diffgeo/"><strong>微分几何笔记</strong></a></li>
<li><a href="/notes/docs/mlapp/"><strong>机器学习：概率视角</strong></a></li>
<li><a href="/notes/docs/apm/"><strong>主动投资组合管理</strong></a></li>
</ul>












</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/notes/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Unicorn：统一的连续介质力学求解器（下）【翻译】</strong>

  <label for="toc-control">
    <img src="/notes/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#ii实现18unicorn统一的连续介质力学求解器下">II.实现》18.Unicorn：统一的连续介质力学求解器（下）</a>
      <ul>
        <li><a href="#185-解决连续介质力学问题">18·5 解决连续介质力学问题</a>
          <ul>
            <li><a href="#1851-流固耦合">18·5·1 流固耦合</a></li>
            <li><a href="#1852-自适应性">18·5·2 自适应性</a></li>
            <li><a href="#1853-unicorn-hpc安装和基本测试">18·5·3 Unicorn-HPC安装和基本测试</a></li>
          </ul>
        </li>
        <li><a href="#186-致谢">18·6 致谢</a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      

<nav class="post-pagination">
  
  <a class="newer-posts">
    最后一页
  </a>
  
  
  <a class="older-posts" href="https://chaoskey.gitee.io/notes/docs/fem/0125/">
      上一页<br>Unicorn：统一的连续介质力学求解器（中）【翻译】
  </a>
  
</nav>

<hr>

<article class="markdown">
  <h1>
    <a href="/notes/docs/fem/0126/">Unicorn：统一的连续介质力学求解器（下）【翻译】</a>
  </h1>
  

<div>

  <h5>2021-02-21</h5>


<div>

  
    |
    
      <a href="/notes/categories/%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97">科学计算</a>
      
    |
  

  
    |
    
      <a href="/notes/tags/FEniCS">FEniCS</a>
      , 
      <a href="/notes/tags/%E6%9C%89%E9%99%90%E5%85%83%E6%B3%95">有限元法</a>
      , 
      <a href="/notes/tags/%E5%81%8F%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B">偏微分方程</a>
      
    |
  




    <a href="https://gitee.com/chaoskey/notes/blob/master/content/docs/fem/0126.md#blob-comment" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Comment" />
      评论
    </a>


</div>


</div>

<h1 id="ii实现18unicorn统一的连续介质力学求解器下">II.实现》18.Unicorn：统一的连续介质力学求解器（下）</h1>
<p>【<a href="/notes/docs/fem/#%e7%ac%ac%e5%8d%81%e5%85%ab%e7%ab%a0-unicorn%e7%bb%9f%e4%b8%80%e7%9a%84%e8%bf%9e%e7%bb%ad%e4%bb%8b%e8%b4%a8%e5%8a%9b%e5%ad%a6%e6%b1%82%e8%a7%a3%e5%99%a8">章节目录</a>】</p>
<h2 id="185-解决连续介质力学问题">18·5 解决连续介质力学问题</h2>
<p>在本节中，我们介绍一些使用Unicorn计算的示例。 第一个例子是没有自适应性的流固耦合问题，我们讨论了几何和子域的建模，系数（形式中使用的函数），主程序的参数和规范（运行求解器的接口）。 接下来，我们给出一个用自适应性解决湍流纯流体问题的示例，其中我们涵盖了对偶问题的数据建模，自适应回路，并指定了用于建模湍流边界层的滑移/摩擦边界条件。</p>
<p>我们在这里介绍了问题实现的示例性片段。 有关完整的详细信息，请参见Unicorn源代码分发。</p>
<h3 id="1851-流固耦合">18·5·1 流固耦合</h3>
<p>我们在这里给出解决流固连续介质力学问题的用例，其中用户指定了用于建模问题的数据，并描述了接口和预期结果。 问题在于（Hron和Turek，2005年）给出的FLUSTRUK-A变体3基准，并在（Hoffman等人，2011年）以及第28章中用作Unicorn的验证。 在时间
  
    

    <link rel="stylesheet" href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    
    
    <script defer src="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    
    
    <script defer src="https://cdn.bootcss.com/KaTeX/0.11.1/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body,
                {delimiters: [{left: '$$\n', right: '\n$$', display: true}, {left: '$$', right: '$$', display: false}, 
                              {left: '\\[', right: '\\]', display: true}, {left: '\\(', right: '\\)', display: false}]});"></script>
    
  




<span class="katex">
  \(t = 1\)
</span>
和


<span class="katex">
  \(t = 5.5\)
</span>
时，速度场和相函数


<span class="katex">
  \(\theta\)
</span>
绘制在图18.16中。 完整示例可以在Unicorn发行版<code>unicorn-0.1.3-hpc/ucsolver/fsi/cylinder2D/</code>下找到。</p>
<p><img src="/notes/images/0272.jpg" alt="图18.16"></p>
<center>图18.16 对于FSI基准和用例，时间


<span class="katex">
  \(t = 1\)
</span>
和


<span class="katex">
  \(t = 5.5\)
</span>
的速度和相函数（带有网格）。  在具有12个核（5415个网格点）的分布式网格上并行计算的解决方案。</center>
<p>我们将用例分为四个部分：</p>
<p><strong>几何和子域</strong></p>
<p>用户指定可能的几何参数并定义子域。 我们注意到，对于复杂的几何，用户可以省略几何信息，并将子域标记指定为数据文件。</p>
<p><strong>系数</strong></p>
<p>声明了已知的系数（在形式中出现的函数），例如力函数和边界条件。</p>
<p><strong>参数</strong></p>
<p>在参数文件中给出了指定材料属性和数值公差的简单参数。</p>
<p><strong>主程序</strong></p>
<p>用户实现主程序，并声明数据并将其传递给求解器。</p>
<p>这四个部分通过图18.18–18.21中显示的代码示例展示。</p>
<h3 id="1852-自适应性">18·5·2 自适应性</h3>
<p>我们继续用一个纯流体湍流问题自适应解的用例：环绕3维立方体的流动，该立方体对应于第28章中给出的立方体问题描述。 该解的快照可以在图18.17中看到。 完整示例可在Unicorn发行版的<code>unicorn-0.1.3-hpc/ucsolver/icns/cube/</code>下找到。</p>
<p><img src="/notes/images/0273.jpg" alt="图18.17"></p>
<center>图18.17 环绕立方体流动：最细的网格的速度（上部）和压力（下部）的快照。</center>
<p><img src="/notes/images/0274.jpg" alt="图18.18"></p>
<center>图18.18 Unicorn求解器FSI用例的第1部分：几何和子域。</center>
<p><img src="/notes/images/0275.jpg" alt="图18.19"></p>
<center>图18.19 Unicorn求解器FSI用例的第2部分：系数。</center>
<p><img src="/notes/images/0276.jpg" alt="图18.20"></p>
<center>图18.20 FSI用例的第3部分：参数文件</center>
<p><img src="/notes/images/0277.jpg" alt="图18.21"></p>
<center>图18.21 FSI用例的第4部分：主程序的结构，将数据传递到求解器。</center>
<p>问题的实现与流固的情况非常相似（仅使用纯流体数据），但有3个重要的补充：</p>
<p><strong>对偶问题</strong></p>
<p>为了计算自适应算法所需的误差估计，我们必须求解由原始问题产生的对偶问题和输出量


<span class="katex">
  \(\psi\)
</span>
。 由于对偶问题在形式上与原始问题相似，因此我们将两者都实现为同一求解器的变体。  在这种情况下，我们对计算阻力感兴趣，将


<span class="katex">
  \(\psi\)
</span>
作为对偶问题的边界条件：</p>
<p><strong>自适应回路</strong></p>
<p>我们指定一个solve()函数，该函数计算自适应循环的一次迭代：求解原始问题，求解对偶问题，计算误差估计并检查是否满足公差并计算自适应网格。 此函数在unicorn_solve()函数中的自适应循环中被调用。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Dual_BC_Momentum</span> <span style="color:#f92672">:</span> <span style="color:#66d9ef">public</span> Function
{
<span style="color:#66d9ef">public</span><span style="color:#f92672">:</span>
    Dual_BC_Momentum(Mesh<span style="color:#f92672">&amp;</span> mesh) <span style="color:#f92672">:</span> Function(mesh) {}
    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">eval</span>(real<span style="color:#f92672">*</span> values, <span style="color:#66d9ef">const</span> real<span style="color:#f92672">*</span> x) <span style="color:#66d9ef">const</span>
    {
        values[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1.0</span>;
        values[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>;
        values[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.0</span>;
    }
};

solve()
{
    <span style="color:#75715e">// Boundary condition for dual problem
</span><span style="color:#75715e"></span>    CubeBoundary cb;
    Dual_BC_Momentum <span style="color:#a6e22e">dual_bcf_mom</span>(mesh);

    DirichletBC <span style="color:#a6e22e">dual_bc0</span>(dual_bcf_mom, mesh, cb);
    Array <span style="color:#f92672">&lt;</span>BoundaryCondition<span style="color:#f92672">*&gt;</span> dual_bc_mom;
    dual_bc_mom.push_back(<span style="color:#f92672">&amp;</span>dual_bc0);
    ...

    <span style="color:#75715e">// Solve primal problem
</span><span style="color:#75715e"></span>    NSESolver primal_solver(mesh, node_normal, f, beta, aero_f, 
        primal_bc_mom, primal_bc_con, chkp, w_limit, td, <span style="color:#e6db74">&#34;primal&#34;</span>);
    primal_solver.solve();

    <span style="color:#75715e">// Solve dual problem (gives weight for error estimate)
</span><span style="color:#75715e"></span>    NSESolver <span style="color:#a6e22e">dual_solver</span>(mesh, node_normal, f, beta, aero_f, dual_bc_mom, 
        dual_bc_con, chkp, w_limit, td, <span style="color:#e6db74">&#34;dual&#34;</span>);
    dual_solver.solve();

}
</code></pre></div><p><strong>滑移边界条件</strong></p>
<p>对于湍流，我们将边界层建模为摩擦边界条件。 我们将法向分量指定为与常规Dirichlet边界条件相同的强滑动边界条件。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c++" data-lang="c++">NodeNormal <span style="color:#a6e22e">node_normal</span>(mesh);
SlipBoundary sb;

SlipBC <span style="color:#a6e22e">slip_bc</span>(mesh, sb, node_normal);
Array <span style="color:#f92672">&lt;</span>BoundaryCondition<span style="color:#f92672">*&gt;</span> primal_bc_mom;
primal_bc_mom.push_back(<span style="color:#f92672">&amp;</span>slip_bc);
</code></pre></div><h3 id="1853-unicorn-hpc安装和基本测试">18·5·3 Unicorn-HPC安装和基本测试</h3>
<p>Unicorn-HPC是Unicorn的高性能计算分支，并且是积极开发的分支。 与本书各章相对应的版本是“ Unicorn 0.1.3-hpc”。 对于以前发表的文章中引用的模拟和绘图，我们参考该特定文章以获取软件详细信息。 当前，Unicorn的MAdLib网格自适应接口仅在不再维护的Unicorn串行分支中可用，我们在Live DVD unicorn_fenics-book.iso中提供了该分支，可通过以下任一方式获得 <a href="http://www.csc.kth.se/ctl">http://www.csc.kth.se/ctl</a> or <a href="http://fenicsproject.org">http://fenicsproject.org</a>.</p>
<p>要验证Unicorn-HPC的正确安装和功能，请遵循Unicorn-HPC发行版中“测试”下自述文件中的步骤。 该测试代表了第28章及更高版本中描述的环绕立方体模拟的湍流。</p>
<h2 id="186-致谢">18·6 致谢</h2>
<p>我们感谢以下公司对Unicorn的贡献，软件开发以及思想和科学支持：Mattias Aechtner，Peter Brune，Zilan Ciftci，GéetanCompere，Claes Johnson，Ashraful Kadir，KasparMüller，JeannetteSpühler，MichaelStöckli和Rodrigo Vilela de Abreu。</p>
<p>作者要感谢欧洲研究委员会，瑞典战略研究基金会，瑞典研究委员会和瑞典能源署的财政支持。 这些模拟是由瑞典国家基础设施计算中心（SNIC），高性能计算中心北部（HPC2N），瑞典国家超级计算机中心（NSC）和PDC –高性能计算中心提供的资源执行的。</p>
<p>【<a href="/notes/docs/fem/#%e7%ac%ac%e5%8d%81%e5%85%ab%e7%ab%a0-unicorn%e7%bb%9f%e4%b8%80%e7%9a%84%e8%bf%9e%e7%bb%ad%e4%bb%8b%e8%b4%a8%e5%8a%9b%e5%ad%a6%e6%b1%82%e8%a7%a3%e5%99%a8">章节目录</a>】</p></article>

<hr>

<nav class="post-pagination">
  
  <a class="newer-posts">
    最后一页
  </a>
  
  
  
  <a class="older-posts" href="https://chaoskey.gitee.io/notes/docs/fem/0125/">
      上一页<br>Unicorn：统一的连续介质力学求解器（中）【翻译】
  </a>
  
</nav>

 

      <footer class="book-footer">
        
  <div class="flex justify-between">





  <div>
    <a class="flex align-center" href="https://gitee.com/chaoskey/notes/blob/master/content/docs/fem/0126.md#blob-comment" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Comment" />
      <span>评论</span>
    </a>
  </div>
  
  
  <div>
    <a class="flex align-center" href="https://gitee.com/-/ide/project/chaoskey/notes/edit/master/-/content/docs/fem/0126.md" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>编辑本页</span>
    </a>
  </div>

</div>

 
        
  
  <div class="book-comments">

</div>
  
  
      </footer>
      
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#ii实现18unicorn统一的连续介质力学求解器下">II.实现》18.Unicorn：统一的连续介质力学求解器（下）</a>
      <ul>
        <li><a href="#185-解决连续介质力学问题">18·5 解决连续介质力学问题</a>
          <ul>
            <li><a href="#1851-流固耦合">18·5·1 流固耦合</a></li>
            <li><a href="#1852-自适应性">18·5·2 自适应性</a></li>
            <li><a href="#1853-unicorn-hpc安装和基本测试">18·5·3 Unicorn-HPC安装和基本测试</a></li>
          </ul>
        </li>
        <li><a href="#186-致谢">18·6 致谢</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












