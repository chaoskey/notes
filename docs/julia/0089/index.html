<!DOCTYPE html>
<html lang="cn">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="有限差分法求解一维热传导方程"><meta property="og:title" content="有限差分法求解一维热传导方程" />
<meta property="og:description" content="# 奇怪：这个库必须放在最前面才能一次加载成功
using Plots
gr()
Plots.GRBackend()
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chaoskey.gitee.io/notes/docs/julia/0089/" />
<meta property="article:published_time" content="2020-11-01T11:06:14+08:00" />
<meta property="article:modified_time" content="2020-11-01T11:06:14+08:00" />
<title>有限差分法求解一维热传导方程 | 学习笔记</title>
<link rel="icon" href="/notes/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/notes/book.min.3a0afab795624b6557eb098eddc1c880180827e07fdb828f747c01148048289e.css" integrity="sha256-Ogr6t5ViS2VX6wmO3cHIgBgIJ&#43;B/24KPdHwBFIBIKJ4=">


<script defer src="/notes/cn.search.min.d1c6aa77add781ac6d33c28dc2572e4eda52fc8fd7f5a629c4ac0c43eaf39ed2.js" integrity="sha256-0caqd63XgaxtM8KNwlcuTtpS/I/X9aYpxKwMQ&#43;rzntI="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/notes"><img src="/notes/logo.png" alt="Logo" /><span>学习笔记</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="搜索" aria-label="搜索" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>









  










    
    



<ul>
<li><a href="/notes/posts/"><strong>站点维护记录</strong></a></li>
<li><a href="/notes/docs/fem/"><strong>有限元法自动求解微分方程</strong></a></li>
<li><a href="/notes/docs/julia/"><strong>基于Julia科学计算</strong></a>
<ul>
<li><a href="/notes/docs/julia/0001/">整合Julia和Python的集成环境（Win10）</a></li>
<li><a href="/notes/docs/julia/0095/">科学计算环境搭建（Win10+WSL2+Ubuntu）</a></li>
<li><a href="/notes/docs/julia/0002/">Julia中的数学符号演算</a></li>
<li><a href="/notes/docs/julia/0003/">基于Julia的科学计算功能库整理</a></li>
<li><a href="/notes/docs/diffgeo/0070/">微分几何中的计算</a></li>
<li><a href="/notes/docs/julia/0088/">平面三体问题</a></li>
<li><a href="/notes/docs/julia/0089/"class=active>有限差分法求解一维热传导方程</a></li>
<li><a href="/notes/docs/julia/0090/">Galerkin法解常微分方程边值问题</a></li>
<li><a href="/notes/docs/julia/0091/">有限元法解常微分方程边值问题</a></li>
<li><a href="/notes/docs/julia/0092/">有限元之平面三角单元</a></li>
<li><a href="/notes/docs/julia/0093/">有限元之Delaunay三角剖分</a></li>
<li><a href="/notes/docs/julia/0094/">有限元法解偏微分方程（FEniCS）</a></li>
<li><a href="/notes/docs/julia/0096/">有限元法求解牛顿流体（FEniCS）</a></li>
</ul>
</li>
<li><a href="/notes/docs/theophy/"><strong>理论物理学习笔记</strong></a></li>
<li><a href="/notes/docs/diffgeo/"><strong>微分几何笔记</strong></a></li>
<li><a href="/notes/docs/mlapp/"><strong>机器学习：概率视角</strong></a></li>
<li><a href="/notes/docs/apm/"><strong>主动投资组合管理</strong></a></li>
</ul>












</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/notes/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>有限差分法求解一维热传导方程</strong>

  <label for="toc-control">
    <img src="/notes/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#有限差分法求解一维热传导方程">有限差分法求解一维热传导方程</a></li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      

<nav class="post-pagination">
  
  <a class="newer-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0090/">
    下一页<br>Galerkin法解常微分方程边值问题
  </a>
  
  
  <a class="older-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0088/">
      上一页<br>平面三体问题（Julia版）
  </a>
  
</nav>

<hr>

<article class="markdown">
  <h1>
    <a href="/notes/docs/julia/0089/">有限差分法求解一维热传导方程</a>
  </h1>
  

<div>

  <h5>2020-11-01</h5>


<div>

  
    |
    
      <a href="/notes/categories/%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97">科学计算</a>
      
    |
  

  
    |
    
      <a href="/notes/tags/julia">julia</a>
      , 
      <a href="/notes/tags/%E6%9C%89%E9%99%90%E5%B7%AE%E5%88%86">有限差分</a>
      , 
      <a href="/notes/tags/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B">微分方程</a>
      , 
      <a href="/notes/tags/%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97">数值计算</a>
      
    |
  




    <a href="https://gitee.com/chaoskey/notes/blob/master/content/docs/julia/0089.md#blob-comment" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Comment" />
      评论
    </a>


</div>


</div>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#75715e"># 奇怪：这个库必须放在最前面才能一次加载成功</span>
<span style="color:#66d9ef">using</span> Plots
gr()
</code></pre></div><pre><code>Plots.GRBackend()
</code></pre>
<h1 id="有限差分法求解一维热传导方程">有限差分法求解一维热传导方程</h1>

  
    

    <link rel="stylesheet" href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    
    
    <script defer src="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    
    
    <script defer src="https://cdn.bootcss.com/KaTeX/0.11.1/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body,
                {delimiters: [{left: '$$\n', right: '\n$$', display: true}, {left: '$$', right: '$$', display: false}, 
                              {left: '\\[', right: '\\]', display: true}, {left: '\\(', right: '\\)', display: false}]});"></script>
    
  




<span class="katex">
  \[
\frac{\partial u}{\partial t}=\lambda \frac{\partial^2 u}{\partial x^2}
\]
</span>

<p>具体为(时长T，杆长L)：</p>



<span class="katex">
  \[
\begin{aligned}  \frac{\partial u(x,t)}{\partial t}&= \lambda \frac{\partial ^2 u(x,t) }{\partial x^2} \qquad 0\leq t\leq T, 0\leq x \leq L   \\  u(x,0)&=4x(L-x)\\  u(0,t)&=0\\  u(L,t)&=0 \end{aligned} 
\]
</span>

<p>选择合适的步长：


<span class="katex">
  \(\tau,h\)
</span>
，确保


<span class="katex">
  \(n=T/\tau,m=L/h\)
</span>
都是整数步。</p>
<p>进而有如下递推关系(序号从0开始标注)：</p>



<span class="katex">
  \[
\begin{aligned}  u_{i,j+1}&=\frac{\lambda\tau}{h^2}u_{i+1,j}+(1-\frac{2\lambda\tau}{h^2})u_{i,j}+\frac{\lambda\tau}{h^2}u_{i-1,j} \\  & \qquad  \qquad  \qquad i=1, 2, \dots,(m-1)  \qquad j=0,1,\dots,(n-1)  \\  u_{i,0}&=4 x_i(L-x_i) \qquad x_i = i h \qquad i=0, 1, \dots,m  \\  u_{0,j}&=0    \qquad j=0, 1, \dots,n \\  u_{m,j}&=0   \qquad j=0, 1, \dots,n \end{aligned} 
\]
</span>

<p>可用Julia实现之（注意代码中数组序号从1开始）：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#75715e"># 参数确定</span>
λ<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>; L<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>; T<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>; m<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>; n<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>;
(h,τ) <span style="color:#f92672">=</span> (L<span style="color:#f92672">/</span>m, T<span style="color:#f92672">/</span>n);

<span style="color:#75715e"># 网格点坐标序列</span>
t <span style="color:#f92672">=</span> [(i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>τ <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)];
x <span style="color:#f92672">=</span> [(j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>h <span style="color:#66d9ef">for</span> j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>(m<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)];

<span style="color:#75715e"># 分配空间</span>
u <span style="color:#f92672">=</span> zeros(m<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);

<span style="color:#75715e"># 边界赋值(零值边界不用赋值)</span>
u[<span style="color:#f92672">:</span>,<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">4</span><span style="color:#f92672">*</span>x<span style="color:#f92672">.*</span>(L<span style="color:#f92672">.-</span>x);

<span style="color:#75715e"># 按递推公式计算</span>
<span style="color:#66d9ef">for</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>n
    <span style="color:#66d9ef">for</span> k <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span>m
        i <span style="color:#f92672">=</span> m<span style="color:#f92672">-</span>k<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>
        u[i,j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>(λ<span style="color:#f92672">*</span>τ<span style="color:#f92672">/</span>h<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>u[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,j]<span style="color:#f92672">+</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>λ<span style="color:#f92672">*</span>τ<span style="color:#f92672">/</span>h<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>u[i,j]<span style="color:#f92672">+</span>(λ<span style="color:#f92672">*</span>τ<span style="color:#f92672">/</span>h<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>u[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,j]
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>;

</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">plot(t, x, u, xlabel<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;t&#34;</span>, ylabel<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;x&#34;</span>)
</code></pre></div><p><img src="/notes/images/0154.svg" alt="0154.svg"></p>
<blockquote>
<p>《微分方程数值解法（第4版）-李荣华＆刘播-高等教育出版社-2009》</p>
</blockquote></article>

<hr>

<nav class="post-pagination">
  
  <a class="newer-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0090/">
    下一页<br>Galerkin法解常微分方程边值问题
  </a>
  
  
  
  <a class="older-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0088/">
      上一页<br>平面三体问题（Julia版）
  </a>
  
</nav>

 

      <footer class="book-footer">
        
  <div class="flex justify-between">





  <div>
    <a class="flex align-center" href="https://gitee.com/chaoskey/notes/blob/master/content/docs/julia/0089.md#blob-comment" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Comment" />
      <span>评论</span>
    </a>
  </div>
  
  
  <div>
    <a class="flex align-center" href="https://gitee.com/-/ide/project/chaoskey/notes/edit/master/-/content/docs/julia/0089.md" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>编辑本页</span>
    </a>
  </div>

</div>

 
        
  
  <div class="book-comments">

</div>
  
  
      </footer>
      
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#有限差分法求解一维热传导方程">有限差分法求解一维热传导方程</a></li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












