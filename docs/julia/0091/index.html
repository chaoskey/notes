<!DOCTYPE html>
<html lang="cn">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="有限元法解常微分方程边值问题"><meta property="og:title" content="有限元法解常微分方程边值问题" />
<meta property="og:description" content="有限元法可归结为如下几个步骤：

转换成变分问题（应该会用到边界条件）

2）对解域进行刨分（可以是不均匀）
3）构造基函数（本篇采用基于线性插值的基函数）
4）推导出有限元方程
5）求解有限元方程
6）收敛性和误差估计" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chaoskey.gitee.io/notes/docs/julia/0091/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2020-11-02T12:25:49&#43;08:00" />
<meta property="article:modified_time" content="2020-11-02T12:25:49&#43;08:00" />

<title>有限元法解常微分方程边值问题 | 学习笔记</title>
<link rel="icon" href="/notes/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/notes/book.min.07a0a866d76192b38577628c20f8f349c797682bd8a0d6b3d18465b8420bd2fb.css" integrity="sha256-B6CoZtdhkrOFd2KMIPjzSceXaCvYoNaz0YRluEIL0vs=">


<script defer src="/notes/cn.search.min.7478184bec8c1596b39dd6644b3d22a4548027de995c3895807c8ed6287aad32.js" integrity="sha256-dHgYS&#43;yMFZazndZkSz0ipFSAJ96ZXDiVgHyO1ih6rTI="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/notes"><img src="/notes/logo.png" alt="Logo" /><span>学习笔记</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="搜索" aria-label="搜索" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>









  










    
    



<ul>
<li><a href="/notes/posts/"><strong>杂事记录</strong></a></li>
<li><a href="/notes/docs/fem/"><strong>有限元法自动求解微分方程</strong></a></li>
<li><a href="/notes/docs/julia/"><strong>基于Julia科学计算</strong></a>
<ul>
<li><a href="/notes/docs/julia/0001/">整合Julia和Python的集成环境（Win10）</a></li>
<li><a href="/notes/docs/julia/0095/">科学计算环境搭建（Win10+WSL2+Ubuntu）</a></li>
<li><a href="/notes/docs/julia/0002/">Julia中的数学符号演算</a></li>
<li><a href="/notes/docs/julia/0003/">基于Julia的科学计算功能库整理</a></li>
<li><a href="/notes/docs/diffgeo/0070/">微分几何中的计算</a></li>
<li><a href="/notes/docs/julia/0088/">平面三体问题</a></li>
<li><a href="/notes/docs/julia/0089/">有限差分法求解一维热传导方程</a></li>
<li><a href="/notes/docs/julia/0090/">Galerkin法解常微分方程边值问题</a></li>
<li><a href="/notes/docs/julia/0091/"class=active>有限元法解常微分方程边值问题</a></li>
<li><a href="/notes/docs/julia/0092/">有限元之平面三角单元</a></li>
<li><a href="/notes/docs/julia/0093/">有限元之Delaunay三角剖分</a></li>
<li><a href="/notes/docs/julia/0094/">有限元法解偏微分方程（FEniCS）</a></li>
<li><a href="/notes/docs/julia/0096/">有限元法求解牛顿流体（FEniCS）</a></li>
</ul>
</li>
<li><a href="/notes/docs/theophy/"><strong>理论物理学习笔记</strong></a></li>
<li><a href="/notes/docs/diffgeo/"><strong>微分几何笔记</strong></a></li>
<li><a href="/notes/docs/mlapp/"><strong>机器学习：概率视角</strong></a></li>
<li><a href="/notes/docs/apm/"><strong>主动投资组合管理</strong></a></li>
</ul>












</nav>




  <script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/notes/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>有限元法解常微分方程边值问题</strong>

  <label for="toc-control">
    <img src="/notes/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents"></nav>


    </aside>
  
 
      </header>

      

<nav class="post-pagination">
  
  <a class="newer-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0092/">
    下一页<br>有限元之平面三角单元
  </a>
  
  
  <a class="older-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0090/">
      上一页<br>Galerkin法解常微分方程边值问题
  </a>
  
</nav>

<hr>

<article class="markdown">
  <h1>
    <a href="/notes/docs/julia/0091/">有限元法解常微分方程边值问题</a>
  </h1>
  

<div>

  <h5>2020-11-02</h5>


<div>

  
    |
    
      <a href="/notes/categories/%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97">科学计算</a>
      
    |
  

  
    |
    
      <a href="/notes/tags/julia">julia</a>
      , 
      <a href="/notes/tags/%E6%9C%89%E9%99%90%E5%85%83%E6%B3%95">有限元法</a>
      , 
      <a href="/notes/tags/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B">微分方程</a>
      , 
      <a href="/notes/tags/%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97">数值计算</a>
      
    |
  




    <a href="https://gitee.com/chaoskey/notes/blob/master/content/docs/julia/0091.md#blob-comment" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Comment" />
      评论
    </a>


</div>


</div>

<p>有限元法可归结为如下几个步骤：</p>
<ol>
<li>转换成变分问题（应该会用到边界条件）</li>
</ol>
<p>2）对解域进行刨分（可以是不均匀）</p>
<p>3）构造基函数（本篇采用基于线性插值的基函数）</p>
<p>4）推导出有限元方程</p>
<p>5）求解有限元方程</p>
<p>6）收敛性和误差估计</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#75715e"># 奇怪：这个库必须放在最前面才能一次加载成功</span>
<span style="color:#66d9ef">using</span> Plots
gr()

<span style="color:#75715e"># 解决Colab不显示输出数学公式的问题</span>
<span style="color:#66d9ef">using</span> Markdown<span style="color:#f92672">:</span> MD, LaTeX
<span style="color:#66d9ef">function</span> latex(expr)
    expr <span style="color:#f92672">|&gt;</span> sympy<span style="color:#f92672">.</span>latex <span style="color:#f92672">|&gt;</span> LaTeX
<span style="color:#66d9ef">end</span>;
</code></pre></div><p>考虑两点边值问题：</p>

  
    

    <link rel="stylesheet" href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    
    
    <script defer src="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    
    
    <script defer src="https://cdn.bootcss.com/KaTeX/0.11.1/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body,
                {delimiters: [{left: '$$\n', right: '\n$$', display: true}, {left: '$$', right: '$$', display: false}, 
                              {left: '\\[', right: '\\]', display: true}, {left: '\\(', right: '\\)', display: false}]});"></script>
    
  




<span class="katex">
  \[
\begin{aligned} &Lu=-\frac{d}{dx}\left(p\frac{du}{dx}\right)+qu=f ,\qquad a < x < b  \\ & u(a)=0,\frac{d}{dx}u(b)=0 \end{aligned}
\]
</span>

<p>对应的变分方程(用到两个边界条件)：</p>



<span class="katex">
  \[
\begin{aligned}&a(u,v)=(f,v),\qquad \forall v \\  & a(u,v)=\int^b_a{\left(p\frac{du}{dx}\frac{dv}{dx}+quv\right)dx}\end{aligned}
\]
</span>

<p>区间剖分（可以不均匀）：</p>



<span class="katex">
  \[
a = x_0 < x_1 < \dots < x_n=b \\ h_i=x_i-x_{i-1}, \qquad h = \mathrm{max} \{h_i\}
\]
</span>

<p>与此对应的近似解序列


<span class="katex">
  \(\{u_i\}\)
</span>
（待求）为：</p>



<span class="katex">
  \[
u_0=0, u_1,u_2,\dots,u_n
\]
</span>

<p>通过这


<span class="katex">
  \(n+1\)
</span>
个点的值可进行线性插值得到近似解


<span class="katex">
  \(u_h(x)\)
</span>
：</p>



<span class="katex">
  \[
\begin{aligned}u_h(x)=\frac{x_i-x}{h_i}u_{i-1}+\frac{x-x_{i-1}}{h_i}u_i,\qquad  x_{i-1} < x < x_i \end{aligned}
\]
</span>

<p>可引入线性无关的“山形函数”序列


<span class="katex">
  \(\varphi_i(x)\)
</span>
构成基底：</p>
<p><img src="" alt="0166.jpg)    "></p>



<span class="katex">
  \[
\boxed{\xi = \frac{x-x_{i-1}}{h_i}\qquad x_{i-1} < x < x_i\qquad 0<\xi<1}
\]
</span>




<span class="katex">
  \[
\varphi_0(x)=\left\{\begin{aligned}&1-\xi,  &x_0 < x < x_1 \\ &0, & 其它\end{aligned}\right .
\]
</span>




<span class="katex">
  \[
\varphi_i(x)=\left\{\begin{aligned}&\xi,  &x_{i-1} < x < x_i \\ &1-\xi,& x_i < x < x_{i+1} \\ &0, & 其它\end{aligned}\right . \qquad i=1,2,\dots,n-1
\]
</span>




<span class="katex">
  \[
\varphi_n(x)=\left\{\begin{aligned}&\xi,  &x_{n-1} < x < x_n \\ &0, & 其它\end{aligned}\right .
\]
</span>

<p>不难验证，前面的线性插值函数


<span class="katex">
  \(u_h(x)\)
</span>
，可用这个序列


<span class="katex">
  \(\varphi_i\)
</span>
为基底展开(下面考虑了


<span class="katex">
  \(u_0=0\)
</span>
)：</p>



<span class="katex">
  \[
u_h(x)=\sum^n_{i=1}{u_i \varphi_i(x)}
\]
</span>

<p>由图可知（亦可简单验算）：</p>



<span class="katex">
  \[
\varphi_i(x)\varphi_j(x)=0,  \qquad |i-j|\ge 2 \\
\frac{d\varphi_i}{dx}\frac{d\varphi_j}{dx}=0,  \qquad |i-j|\ge 2
\]
</span>

<p>所以


<span class="katex">
  \(a(\varphi_i,\varphi_j)\)
</span>
的非零值只可能有：</p>



<span class="katex">
  \[
\begin{aligned}&a(\varphi_{1},\varphi_1),a(\varphi_{2},\varphi_1) \\ &a(\varphi_{j-1},\varphi_j),a(\varphi_{j},\varphi_j),a(\varphi_{j+1},\varphi_j),\qquad j=2,\dots,n-1\\ & a(\varphi_{n-1},\varphi_n),a(\varphi_{n},\varphi_{n}) \end{aligned}
\]
</span>

<p>可分别算出这三类非零值：</p>



<span class="katex">
  \[
a(\varphi_{j-1},\varphi_j)=\int^1_0{\left[-h_j^{-1}p(x_{j-1}+h_j\xi)+h_j q(x_{j-1}+h_j\xi)(1-\xi)\xi\right]d\xi}
\]
</span>




<span class="katex">
  \[
\begin{aligned}a(\varphi_j,\varphi_j)&=\int^1_0{\left[h_j^{-1}p(x_{j-1}+h_j\xi)+h_j q(x_{j-1}+h_j\xi)\xi^2\right]d\xi} \\ & +\int^1_0{\left[h_{j+1}^{-1}p(x_{j}+h_{j+1}\xi)+h_{j+1} q(x_{j} +h_{j+1}\xi)(1-\xi)^2\right]d\xi}\end{aligned}
\]
</span>




<span class="katex">
  \[
a(\varphi_{j+1},\varphi_j)=\int^1_0{\left[-h_{j+1}^{-1}p(x_{j}+h_{j+1}\xi)+h_{j+1} q(x_{j}+h_{j+1}\xi)(1-\xi)\xi\right]d\xi}
\]
</span>




<span class="katex">
  \[
a(\varphi_n,\varphi_n)=\int^1_0{\left[h_n^{-1}p(x_{n-1}+h_n\xi)+h_n q(x_{n-1}+h_n\xi)\xi^2\right]d\xi} 
\]
</span>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">using</span> SciPy

<span style="color:#75715e"># </span>
<span style="color:#75715e"># “山形”基函数</span>
<span style="color:#75715e">#</span>
<span style="color:#66d9ef">function</span> φ(t,i,x,h,n)
    <span style="color:#66d9ef">if</span> i <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;&amp;</span> t<span style="color:#f92672">&gt;=</span>x[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&amp;&amp;</span> t<span style="color:#f92672">&lt;=</span>x[i]
        <span style="color:#66d9ef">return</span> (t<span style="color:#f92672">-</span>x[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])<span style="color:#f92672">/</span>h[i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    <span style="color:#66d9ef">elseif</span> i <span style="color:#f92672">&lt;</span> n<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">&amp;&amp;</span> t<span style="color:#f92672">&gt;</span>x[i] <span style="color:#f92672">&amp;&amp;</span> t<span style="color:#f92672">&lt;=</span>x[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>(t<span style="color:#f92672">-</span>x[i])<span style="color:#f92672">/</span>h[i]
    <span style="color:#66d9ef">else</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">end</span>
<span style="color:#66d9ef">end</span>;


<span style="color:#75715e"># </span>
<span style="color:#75715e"># a(φ_i,φ_j)</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e">#   假设已有p(t),q(t)</span>
<span style="color:#75715e">#</span>
<span style="color:#66d9ef">function</span> aa(i,j,x,h,n)
    <span style="color:#66d9ef">if</span> abs(i<span style="color:#f92672">-</span>j) <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">2</span>
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">end</span>;
    
    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span>j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
        α(ξ)<span style="color:#f92672">=-</span>p(x[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>ξ)<span style="color:#f92672">/</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>q(x[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>ξ)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>ξ)<span style="color:#f92672">*</span>ξ;
        <span style="color:#66d9ef">return</span> SciPy<span style="color:#f92672">.</span>integrate<span style="color:#f92672">.</span>quad(α, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">1</span>];
    <span style="color:#66d9ef">end</span>;
    
    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span>j <span style="color:#f92672">&amp;&amp;</span> j<span style="color:#f92672">&lt;</span>n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
        β(ξ)<span style="color:#f92672">=</span>p(x[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>ξ)<span style="color:#f92672">/</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>q(x[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>ξ)<span style="color:#f92672">*</span>ξ<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">+</span>p(x[j]<span style="color:#f92672">+</span>h[j]<span style="color:#f92672">*</span>ξ)<span style="color:#f92672">/</span>h[j]<span style="color:#f92672">+</span>h[j]<span style="color:#f92672">*</span>q(x[j]<span style="color:#f92672">+</span>h[j]<span style="color:#f92672">*</span>ξ)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>ξ)<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span>;
        <span style="color:#66d9ef">return</span> SciPy<span style="color:#f92672">.</span>integrate<span style="color:#f92672">.</span>quad(β, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">1</span>];
    <span style="color:#66d9ef">end</span>;
    
    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span>j <span style="color:#f92672">&amp;&amp;</span> j<span style="color:#f92672">==</span>n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
        βn(ξ)<span style="color:#f92672">=</span>p(x[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>ξ)<span style="color:#f92672">/</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>q(x[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>h[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>ξ)<span style="color:#f92672">*</span>ξ<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span>;
        <span style="color:#66d9ef">return</span> SciPy<span style="color:#f92672">.</span>integrate<span style="color:#f92672">.</span>quad(βn, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">1</span>];
    <span style="color:#66d9ef">end</span>;
    
    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span>j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>
        γ(ξ)<span style="color:#f92672">=-</span>p(x[j]<span style="color:#f92672">+</span>h[j]<span style="color:#f92672">*</span>ξ)<span style="color:#f92672">/</span>h[j]<span style="color:#f92672">+</span>h[j]<span style="color:#f92672">*</span>q(x[j]<span style="color:#f92672">+</span>h[j]<span style="color:#f92672">*</span>ξ)<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>ξ)<span style="color:#f92672">*</span>ξ;
        <span style="color:#66d9ef">return</span> SciPy<span style="color:#f92672">.</span>integrate<span style="color:#f92672">.</span>quad(γ, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)[<span style="color:#ae81ff">1</span>];
    <span style="color:#66d9ef">end</span>;      
<span style="color:#66d9ef">end</span>;
</code></pre></div><p>正式求解的julia代码：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">using</span> Random

<span style="color:#75715e"># 参数选定</span>
a<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; b<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
f(t)<span style="color:#f92672">=</span>(pi<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>)sin(pi<span style="color:#f92672">*</span>t<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>);
p(t) <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
q(t) <span style="color:#f92672">=</span> pi<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">4</span>;


<span style="color:#66d9ef">function</span> NSolve(n)
    <span style="color:#75715e"># 随机生成的不均匀的区间刨分</span>
    h <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0.5</span><span style="color:#f92672">*</span>rand()<span style="color:#f92672">+</span><span style="color:#ae81ff">0.5</span> <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>n];
    h <span style="color:#f92672">=</span> (b<span style="color:#f92672">-</span>a)<span style="color:#f92672">*</span>h<span style="color:#f92672">/</span>sum(h);
    x <span style="color:#f92672">=</span> zeros(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);
    x[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>a; x[n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>b;
    x[<span style="color:#ae81ff">2</span><span style="color:#f92672">:</span>n]<span style="color:#f92672">=</span>[sum(h[<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>i]) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span>(n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)];
    h[n]<span style="color:#f92672">=</span>x[n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>]<span style="color:#f92672">-</span>x[n];
    
    <span style="color:#75715e"># 待求近似解</span>
    u <span style="color:#f92672">=</span> zeros(n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>);

    <span style="color:#75715e"># 计算a(φ_i,φ_j)矩阵</span>
    A <span style="color:#f92672">=</span> [aa(i,j,x,h,n) <span style="color:#66d9ef">for</span> j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span>n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span>n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];

    <span style="color:#75715e"># 计算(f,φ_j)列向量</span>
    fφ <span style="color:#f92672">=</span> [SciPy<span style="color:#f92672">.</span>integrate<span style="color:#f92672">.</span>quad(t<span style="color:#f92672">-&gt;</span>f(t)<span style="color:#f92672">*</span>φ(t,j,x,h,n), 
            x[j<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], 
            (j<span style="color:#f92672">==</span>n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">?</span> b <span style="color:#f92672">:</span> x[j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>])
        )[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">for</span> j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">:</span>n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];

    <span style="color:#75715e"># 解出插值端点值</span>
    u[<span style="color:#ae81ff">2</span><span style="color:#f92672">:</span>n<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> inv(A)<span style="color:#f92672">*</span>fφ;
    
    <span style="color:#75715e"># 近似解序列</span>
    (x,u)
<span style="color:#66d9ef">end</span>;
</code></pre></div><p>做为对比，也可解出精确解：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">using</span> SymPy

<span style="color:#a6e22e">@vars</span> t
y <span style="color:#f92672">=</span> SymFunction(<span style="color:#e6db74">&#34;y&#34;</span>)

diffeq <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>diff(y(t),t,<span style="color:#ae81ff">2</span>)<span style="color:#f92672">+</span>(PI<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">4</span>)y(t)<span style="color:#f92672">⩵</span>(PI<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">*</span>sin(t<span style="color:#f92672">*</span>PI<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>)

<span style="color:#75715e"># 通解</span>
ex <span style="color:#f92672">=</span> dsolve(diffeq, y(t))

<span style="color:#75715e"># 根据边界条件确定积分常数</span>
ex1 <span style="color:#f92672">=</span> rhs(ex)
ex2 <span style="color:#f92672">=</span> diff(ex1,t)
eqs <span style="color:#f92672">=</span> [ex1(t<span style="color:#f92672">=&gt;</span><span style="color:#ae81ff">0</span>)<span style="color:#f92672">⩵</span><span style="color:#ae81ff">0</span>,ex2(t<span style="color:#f92672">=&gt;</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">⩵</span><span style="color:#ae81ff">0</span>]
C <span style="color:#f92672">=</span> solve(eqs,[Sym(<span style="color:#e6db74">&#34;C1&#34;</span>),Sym(<span style="color:#e6db74">&#34;C2&#34;</span>)])

<span style="color:#75715e"># 解析解</span>
ex <span style="color:#f92672">=</span> ex(C)
ex <span style="color:#f92672">|&gt;</span> latex <span style="color:#f92672">|&gt;</span> MD
</code></pre></div>


<span class="katex">
  \[
y{\left(t \right)} = \sin{\left(\frac{\pi t}{2} \right)}
\]
</span>

<p>绘制近似解和精确解</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#75715e"># 精确解</span>
plot(rhs(ex),color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span>,xlims<span style="color:#f92672">=</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">0.1</span>, <span style="color:#ae81ff">1.1</span>),label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;U&#34;</span>,xlabel<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;x&#34;</span>,ylabel<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;u(x)&#34;</span>)
<span style="color:#75715e"># 近似解 n=4,8</span>
plot!(NSolve(<span style="color:#ae81ff">4</span>),color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;green&#34;</span>,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;u4&#34;</span>)
plot!(NSolve(<span style="color:#ae81ff">8</span>),color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>,label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;u8&#34;</span>)
</code></pre></div><p><img src="/notes/images/0162.svg" alt="0162.svg"></p>
<blockquote>
<p>《微分方程数值解法（第4版）-李荣华＆刘播-高等教育出版社-2009》</p>
</blockquote></article>

<hr>

<nav class="post-pagination">
  
  <a class="newer-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0092/">
    下一页<br>有限元之平面三角单元
  </a>
  
  
  
  <a class="older-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0090/">
      上一页<br>Galerkin法解常微分方程边值问题
  </a>
  
</nav>

 

      <footer class="book-footer">
        
  <div class="flex justify-between">





  <div>
    <a class="flex align-center" href="https://gitee.com/chaoskey/notes/blob/master/content/docs/julia/0091.md#blob-comment" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Comment" />
      <span>评论</span>
    </a>
  </div>
  
  
  <div>
    <a class="flex align-center" href="https://gitee.com/-/ide/project/chaoskey/notes/edit/master/-/content/docs/julia/0091.md" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>编辑本页</span>
    </a>
  </div>

</div>

 
        
  
  <div class="book-comments">

</div>
  
  
      </footer>
      
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents"></nav>

 
    </aside>
    
  </main>

  
</body>

</html>












