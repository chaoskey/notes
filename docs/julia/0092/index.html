<!DOCTYPE html>
<html lang="cn">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="有限元之平面三角单元"><meta property="og:title" content="有限元之平面三角单元" />
<meta property="og:description" content="本文是有限元法基础之一：三角单元。
用
  
    

    
    
    
    
    
    
    
    
  





  \(\color{red}{红色}\)

标注的公式，都给了完整的符号推导（基于Julia）。
参考文献： 微分方程数值解法（第4版）-李荣华＆刘播-高等教育出版社-2009" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chaoskey.gitee.io/notes/docs/julia/0092/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2020-11-04T08:56:50&#43;08:00" />
<meta property="article:modified_time" content="2020-11-04T08:56:50&#43;08:00" />

<title>有限元之平面三角单元 | 学习笔记</title>
<link rel="icon" href="/notes/favicon.png" type="image/x-icon">


<link rel="stylesheet" href="/notes/book.min.0253b76936e9496c1a48e74d90cdc268fd0e96366c60a1f43994801cc334588a.css" integrity="sha256-AlO3aTbpSWwaSOdNkM3CaP0OljZsYKH0OZSAHMM0WIo=">


<script defer src="/notes/cn.search.min.f734b55049115fd51afdc9f74cd5d979d8ff31b218dc3721a5f645b9690cfef4.js" integrity="sha256-9zS1UEkRX9Ua/cn3TNXZedj/MbIY3DchpfZFuWkM/vQ="></script>

<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body>
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/notes"><img src="/notes/logo.png" alt="Logo" /><span>学习笔记</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="搜索" aria-label="搜索" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>









  










    
    



<ul>
<li><a href="/notes/posts/"><strong>杂事记录</strong></a></li>
<li><a href="/notes/docs/fem/"><strong>有限元法自动求解微分方程</strong></a></li>
<li><a href="/notes/docs/julia/"><strong>基于Julia科学计算</strong></a>
<ul>
<li><a href="/notes/docs/julia/0001/">整合Julia和Python的集成环境（Win10）</a></li>
<li><a href="/notes/docs/julia/0095/">科学计算环境搭建（Win10+WSL2+Ubuntu）</a></li>
<li><a href="/notes/docs/julia/0002/">Julia中的数学符号演算</a></li>
<li><a href="/notes/docs/julia/0003/">基于Julia的科学计算功能库整理</a></li>
<li><a href="/notes/docs/diffgeo/0070/">微分几何中的计算</a></li>
<li><a href="/notes/docs/julia/0088/">平面三体问题</a></li>
<li><a href="/notes/docs/julia/0089/">有限差分法求解一维热传导方程</a></li>
<li><a href="/notes/docs/julia/0090/">Galerkin法解常微分方程边值问题</a></li>
<li><a href="/notes/docs/julia/0091/">有限元法解常微分方程边值问题</a></li>
<li><a href="/notes/docs/julia/0092/"class=active>有限元之平面三角单元</a></li>
<li><a href="/notes/docs/julia/0093/">有限元之Delaunay三角剖分</a></li>
<li><a href="/notes/docs/julia/0094/">有限元法解偏微分方程（FEniCS）</a></li>
<li><a href="/notes/docs/julia/0096/">有限元法求解牛顿流体（FEniCS）</a></li>
</ul>
</li>
<li><a href="/notes/docs/theophy/"><strong>理论物理学习笔记</strong></a></li>
<li><a href="/notes/docs/diffgeo/"><strong>微分几何笔记</strong></a></li>
<li><a href="/notes/docs/mlapp/"><strong>机器学习：概率视角</strong></a></li>
<li><a href="/notes/docs/apm/"><strong>主动投资组合管理</strong></a></li>
</ul>












</nav>




  <script>(function(){var a=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/notes/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>有限元之平面三角单元</strong>

  <label for="toc-control">
    <img src="/notes/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#三角单元内点的面积坐标">三角单元内点的面积坐标</a></li>
    <li><a href="#三角元上的多项式插值">三角元上的多项式插值</a>
      <ul>
        <li><a href="#一次多项式插值">一次多项式插值</a></li>
        <li><a href="#二次多项式插值">二次多项式插值</a></li>
        <li><a href="#三次多项式插值">三次多项式插值</a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      

<nav class="post-pagination">
  
  <a class="newer-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0093/">
    下一页<br>有限元之Delaunay三角剖分
  </a>
  
  
  <a class="older-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0091/">
      上一页<br>有限元法解常微分方程边值问题
  </a>
  
</nav>

<hr>

<article class="markdown">
  <h1>
    <a href="/notes/docs/julia/0092/">有限元之平面三角单元</a>
  </h1>
  

<div>

  <h5>2020-11-04</h5>


<div>

  
    |
    
      <a href="/notes/categories/%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97">科学计算</a>
      
    |
  

  
    |
    
      <a href="/notes/tags/julia">julia</a>
      , 
      <a href="/notes/tags/%E6%9C%89%E9%99%90%E5%85%83%E6%B3%95">有限元法</a>
      
    |
  




    <a href="https://gitee.com/chaoskey/notes/blob/master/content/docs/julia/0092.md#blob-comment" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Comment" />
      评论
    </a>


</div>


</div>

<p>本文是有限元法基础之一：三角单元。</p>
<p>用
  
    

    <link rel="stylesheet" href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    
    
    <script defer src="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    
    
    <script defer src="https://cdn.bootcss.com/KaTeX/0.11.1/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body,
                {delimiters: [{left: '$$\n', right: '\n$$', display: true}, {left: '$$', right: '$$', display: false}, 
                              {left: '\\[', right: '\\]', display: true}, {left: '\\(', right: '\\)', display: false}]});"></script>
    
  




<span class="katex">
  \(\color{red}{红色}\)
</span>
标注的公式，都给了完整的符号推导（基于Julia）。</p>
<p><strong>参考文献</strong>： 微分方程数值解法（第4版）-李荣华＆刘播-高等教育出版社-2009</p>
<h1 id="三角单元内点的面积坐标">三角单元内点的面积坐标</h1>
<p>三角形元


<span class="katex">
  \(\Delta(i,j,k)\)
</span>
内任意一点p，可用


<span class="katex">
  \((x,y)\)
</span>
表示。也可用“归一化面积”，即所谓<strong>面积坐标</strong>


<span class="katex">
  \((l_i,l_j,l_k)\)
</span>
表示。 


<span class="katex">
  \(l_i\)
</span>
就是


<span class="katex">
  \(\Delta(j,k,p)\)
</span>
对应的归一化面积，


<span class="katex">
  \(l_j,l_k\)
</span>
类似。</p>
<p>给定


<span class="katex">
  \((x,y)\)
</span>
，可求出“面积坐标”


<span class="katex">
  \((l_1,l_2,l_2)\)
</span>
：</p>



<span class="katex">
  \[
\boxed{\color{red}{\left\{\begin{aligned}l_1&=\frac{1}{2S}\left[(x_2 y_3-x_3 y_2)+(y_2-y_3)x+(x_3-x_2)y\right]\\ l_2&=\frac{1}{2S}\left[(x_3 y_1-x_1 y_3)+(y_3-y_1)x+(x_1-x_3)y\right]\\ l_3&=\frac{1}{2S}\left[(x_1 y_2-x_2 y_1)+(y_1-y_2)x+(x_2-x_1)y\right]\end{aligned} \right.}} \\ 2S=\begin{vmatrix}1 & x_1 & y_1 \\ 1 & x_2 & y_2 \\ 1 & x_3 & y_3 \end{vmatrix}  \\ \quad \\ l_1+l_2+l_3=1
\]
</span>

<p>这个关系可用下面的Julia代码算出（保存在变量<code>LL</code>中）：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#66d9ef">using</span> SymPy

<span style="color:#75715e"># 解决Colab不显示输出数学公式的问题</span>
<span style="color:#66d9ef">using</span> Markdown<span style="color:#f92672">:</span> MD, LaTeX
<span style="color:#66d9ef">function</span> latex(expr)
    expr <span style="color:#f92672">|&gt;</span> sympy<span style="color:#f92672">.</span>latex <span style="color:#f92672">|&gt;</span> LaTeX
<span style="color:#66d9ef">end</span>;

<span style="color:#a6e22e">@vars</span> x y real<span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>

<span style="color:#75715e"># 三个顶点坐标（逆时针排序）</span>
X <span style="color:#f92672">=</span> [symbols(<span style="color:#e6db74">&#34;x</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>, real<span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]
Y <span style="color:#f92672">=</span> [symbols(<span style="color:#e6db74">&#34;y</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>, real<span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]

<span style="color:#75715e"># 面积坐标</span>
L<span style="color:#f92672">=</span>[symbols(<span style="color:#e6db74">&#34;l</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>, positive<span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]

A <span style="color:#f92672">=</span> sympy<span style="color:#f92672">.</span>ones(<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>)
A[<span style="color:#f92672">:</span>,<span style="color:#ae81ff">2</span>]<span style="color:#f92672">=</span>X
A[<span style="color:#f92672">:</span>,<span style="color:#ae81ff">3</span>]<span style="color:#f92672">=</span>Y

<span style="color:#75715e"># 总面积</span>
S <span style="color:#f92672">=</span> sympy<span style="color:#f92672">.</span>det(A)<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>

<span style="color:#75715e"># 三个子面积并作归一化</span>
LL <span style="color:#f92672">=</span> [S(X[i]<span style="color:#f92672">=&gt;</span>x,Y[i]<span style="color:#f92672">=&gt;</span>y) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]<span style="color:#f92672">/</span>S  <span style="color:#f92672">.|&gt;</span> simplify
LL <span style="color:#f92672">=</span> LL <span style="color:#f92672">.|&gt;</span> t<span style="color:#f92672">-&gt;</span>collect(t,[x,y])

<span style="color:#75715e"># 显示</span>
[L[i]⩵LL[i] <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>] <span style="color:#f92672">.|&gt;</span> latex <span style="color:#f92672">|&gt;</span> MD
</code></pre></div>


<span class="katex">
  \[
l_{1} = \frac{x \left(y_{2} - y_{3}\right) + x_{2} y_{3} - x_{3} y_{2} + y \left(- x_{2} + x_{3}\right)}{x_{1} y_{2} - x_{1} y_{3} - x_{2} y_{1} + x_{2} y_{3} + x_{3} y_{1} - x_{3} y_{2}}
\]
</span>




<span class="katex">
  \[
l_{2} = \frac{x \left(- y_{1} + y_{3}\right) - x_{1} y_{3} + x_{3} y_{1} + y \left(x_{1} - x_{3}\right)}{x_{1} y_{2} - x_{1} y_{3} - x_{2} y_{1} + x_{2} y_{3} + x_{3} y_{1} - x_{3} y_{2}}
\]
</span>




<span class="katex">
  \[
l_{3} = \frac{x \left(y_{1} - y_{2}\right) + x_{1} y_{2} - x_{2} y_{1} + y \left(- x_{1} + x_{2}\right)}{x_{1} y_{2} - x_{1} y_{3} - x_{2} y_{1} + x_{2} y_{3} + x_{3} y_{1} - x_{3} y_{2}}
\]
</span>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#75715e"># 验证归一化条件</span>
sum(LL) <span style="color:#f92672">.|&gt;</span> simplify 
</code></pre></div><pre><code> 1
</code></pre>
<p>作为逆变换，给定“面积坐标”


<span class="katex">
  \((l_1,l_2,l_3)\)
</span>
，可求出普通


<span class="katex">
  \((x,y)\)
</span>
：</p>



<span class="katex">
  \[
\color{red}{\boxed{\left\{\begin{aligned}x&=l_1 x_1 + l_2 x_2 + l_3 x_3 \\ y&=l_1 y_1 + l_2 y_2 + l_3 y_3 \end{aligned} \right.}}
\]
</span>

<p>推导如下（用到了归一化条件，保存在变量<code>XX</code>和<code>YY</code>中）：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#75715e"># 反过来，可用面积坐标表示(x,y)</span>
eqs <span style="color:#f92672">=</span> [LL[i]⩵L[i] <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">2</span>]
sol <span style="color:#f92672">=</span> solve(eqs,[x,y])
(XX,YY) <span style="color:#f92672">=</span> [x,y] <span style="color:#f92672">.|&gt;</span> (t<span style="color:#f92672">-&gt;</span>t(sol)) <span style="color:#f92672">.|&gt;</span>   
        (t<span style="color:#f92672">-&gt;</span>collect(t, [X[<span style="color:#ae81ff">3</span>],Y[<span style="color:#ae81ff">3</span>]]))  <span style="color:#f92672">.|&gt;</span> 
        (t<span style="color:#f92672">-&gt;</span>t(L[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>L[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">=&gt;</span><span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>L[<span style="color:#ae81ff">3</span>]))

<span style="color:#75715e"># 显示</span>
[x⩵XX,y⩵YY] <span style="color:#f92672">.|&gt;</span> latex <span style="color:#f92672">|&gt;</span> MD
</code></pre></div>


<span class="katex">
  \[
x = l_{1} x_{1} + l_{2} x_{2} + l_{3} x_{3}
\]
</span>




<span class="katex">
  \[
y = l_{1} y_{1} + l_{2} y_{2} + l_{3} y_{3}
\]
</span>

<p>在面积坐标的表示下，三个顶点坐标分别为(每行代表一个顶点)：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">[LL[j](x<span style="color:#f92672">=&gt;</span>X[i],y<span style="color:#f92672">=&gt;</span>Y[i]) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>, j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>] <span style="color:#f92672">.|&gt;</span> simplify  <span style="color:#f92672">|&gt;</span> latex <span style="color:#f92672">|&gt;</span> MD
</code></pre></div>


<span class="katex">
  \[
\left[\begin{matrix}1 & 0 & 0\\0 & 1 & 0\\0 & 0 & 1\end{matrix}\right]
\]
</span>

<h1 id="三角元上的多项式插值">三角元上的多项式插值</h1>



<span class="katex">
  \[
p_m(x,y)=\sum^m_{i+j=0}{c_{ij}x^iy^j}
\]
</span>

<p>注意，这是一个非齐次多项式。 改用面积坐标表示后，原则上是关于


<span class="katex">
  \(l_1,l_2,l_3\)
</span>
的非齐次多项式。</p>
<p>但由于


<span class="katex">
  \(1=l_1+l_2+l_3\)
</span>
，我们可以在任何位置反复插入


<span class="katex">
  \((l_1+l_2+l_3)\)
</span>
，进而可将低次项提升到最高次项（即


<span class="katex">
  \(m\)
</span>
次）。</p>
<p>所以总是可改写成关于


<span class="katex">
  \(l_1,l_2,l_3\)
</span>
的齐次多项式：</p>



<span class="katex">
  \[
\boxed{p_m(l_1,l_2,l_3)=\sum_{i+j+k=m}{c_{ijk}l_1^i l_2^j l_3^k}}
\]
</span>

<p>这个多项式和原始多项式都是含有


<span class="katex">
  \(\frac{1}{2}(m+1)(m+2)\)
</span>
个待定系数</p>
<h2 id="一次多项式插值">一次多项式插值</h2>



<span class="katex">
  \[
p_1(l_1,l_2,l_3)=c_1 l_1 + c_2 l_2 + c_3 l_3
\]
</span>

<p>三个待定系数，需要三个节点值，恰好可用上三角形有三个点的值


<span class="katex">
  \(u_1,u_2,u_3\)
</span>
。</p>
<p>据此可解出这6个待定系数,进而可写出用面积坐标表示的一次多项式插值：：</p>



<span class="katex">
  \[
\color{red}{\boxed{p_1(l_1,l_2,l_3)=l_1 u_1 + l_2 u_2 + l_3 u_3}}
\]
</span>

<p>推导如下（保存在变量<code>pl</code>中，其实这个结果一望而知）：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#75715e"># 3个节点值</span>
U <span style="color:#f92672">=</span> [symbols(<span style="color:#e6db74">&#34;u</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>, real<span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]
<span style="color:#75715e"># 3个待定系数</span>
C <span style="color:#f92672">=</span> [symbols(<span style="color:#e6db74">&#34;c</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>, real<span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]

<span style="color:#75715e"># 3个顶点面积坐标</span>
M<span style="color:#f92672">=</span> [LL[j](x<span style="color:#f92672">=&gt;</span>X[i],y<span style="color:#f92672">=&gt;</span>Y[i]) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>, j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]  <span style="color:#f92672">.|&gt;</span>  simplify

<span style="color:#75715e"># 一次多项式插值（有待定系数）</span>
p(r,s,t)<span style="color:#f92672">=</span>C[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>r <span style="color:#f92672">+</span> C[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">*</span>s <span style="color:#f92672">+</span> C[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">*</span>t

<span style="color:#75715e"># 3个节点方程</span>
eqs <span style="color:#f92672">=</span> [ p(M[i,<span style="color:#ae81ff">1</span>],M[i,<span style="color:#ae81ff">2</span>],M[i,<span style="color:#ae81ff">3</span>])⩵U[i] <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]

<span style="color:#75715e"># 求解这个线性方程组</span>
solC <span style="color:#f92672">=</span> solve(eqs,C)
pl <span style="color:#f92672">=</span> p(L[<span style="color:#ae81ff">1</span>],L[<span style="color:#ae81ff">2</span>],L[<span style="color:#ae81ff">3</span>])(solC) 

<span style="color:#75715e"># 显示</span>
[symbols(<span style="color:#e6db74">&#34;p1&#34;</span>)⩵pl]  <span style="color:#f92672">.|&gt;</span> latex <span style="color:#f92672">|&gt;</span> MD
</code></pre></div>


<span class="katex">
  \[
p_{1} = l_{1} u_{1} + l_{2} u_{2} + l_{3} u_{3}
\]
</span>

<h2 id="二次多项式插值">二次多项式插值</h2>



<span class="katex">
  \[
p_2(l_1,l_2,l_3)=c_1 l_1^2 + c_2 l_2^2   + c_3 l_3^2  + c_4 l_1 l_2 + c_5 l_2 l_3 + c_6 l_3 l_1
\]
</span>

<p>这有6个待定系数，除了3个顶点节点外，还需要3个边的中点作为节点。</p>
<p>据此可解出这6个待定系数,进而可写出用面积坐标表示的二次多项式插值：</p>



<span class="katex">
  \[
\boxed{\color{red}{p_2(l_1,l_2,l_3)=\sum^3_{i=1}\left[l_i(2l_i-1)u_i+4l_jl_k u_{3+i}\right]}} \\ l_{3+i}=l_i,\qquad j=i+1,k=i+2
\]
</span>

<p>推导如下（用到了归一化条件，保存在变量<code>pl2</code>中）：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#75715e"># 六个节点值</span>
U <span style="color:#f92672">=</span> [symbols(<span style="color:#e6db74">&#34;u</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>, real<span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">6</span>]
<span style="color:#75715e"># 六个待定系数</span>
C <span style="color:#f92672">=</span> [symbols(<span style="color:#e6db74">&#34;c</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>, real<span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">6</span>]

<span style="color:#75715e"># 3个顶点面积坐标</span>
M<span style="color:#f92672">=</span> [LL[j](x<span style="color:#f92672">=&gt;</span>X[i],y<span style="color:#f92672">=&gt;</span>Y[i]) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>, j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]  <span style="color:#f92672">.|&gt;</span>  simplify
<span style="color:#75715e"># 3个边中点坐标</span>
M <span style="color:#f92672">=</span> vcat(M,[(M[i<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,j]<span style="color:#f92672">+</span>M[(i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">%</span><span style="color:#ae81ff">3</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>,j])<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span> <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>, j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]) 

<span style="color:#75715e"># 二次多项式插值（有待定系数）</span>
p2(r,s,t)<span style="color:#f92672">=</span>C[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>r<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> C[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">*</span>s<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> C[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">*</span>t<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> C[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">*</span>r<span style="color:#f92672">*</span>s <span style="color:#f92672">+</span> C[<span style="color:#ae81ff">5</span>]<span style="color:#f92672">*</span>s<span style="color:#f92672">*</span>t <span style="color:#f92672">+</span> C[<span style="color:#ae81ff">6</span>]<span style="color:#f92672">*</span>t<span style="color:#f92672">*</span>r

<span style="color:#75715e"># 6个节点方程</span>
eqs <span style="color:#f92672">=</span> [ p2(M[i,<span style="color:#ae81ff">1</span>],M[i,<span style="color:#ae81ff">2</span>],M[i,<span style="color:#ae81ff">3</span>])⩵U[i] <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">6</span>]

<span style="color:#75715e"># 求解这个线性方程组</span>
solC <span style="color:#f92672">=</span> solve(eqs,C)

<span style="color:#75715e"># 化简（反复利用了归一化条件）</span>
pl2 <span style="color:#f92672">=</span> p2(L[<span style="color:#ae81ff">1</span>],L[<span style="color:#ae81ff">2</span>],L[<span style="color:#ae81ff">3</span>])(solC) 
pl2 <span style="color:#f92672">=</span> collect(pl2 <span style="color:#f92672">|&gt;</span> expand, U) 
pl2 <span style="color:#f92672">=</span> sum(pl2<span style="color:#f92672">.</span>args <span style="color:#f92672">.|&gt;</span> factor)
pl2 <span style="color:#f92672">=</span> pl2(L[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">+</span>L[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">=&gt;</span><span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>L[<span style="color:#ae81ff">1</span>])
pl2 <span style="color:#f92672">=</span> pl2(L[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>L[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">=&gt;</span><span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>L[<span style="color:#ae81ff">2</span>])
pl2 <span style="color:#f92672">=</span> pl2(L[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">+</span>L[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">=&gt;</span><span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>L[<span style="color:#ae81ff">3</span>])
pl2 <span style="color:#f92672">=</span> collect(pl2 <span style="color:#f92672">|&gt;</span> expand, U) <span style="color:#f92672">|&gt;</span>  simplify

<span style="color:#75715e"># 显示</span>
[symbols(<span style="color:#e6db74">&#34;p2&#34;</span>)⩵pl2]  <span style="color:#f92672">.|&gt;</span> latex <span style="color:#f92672">|&gt;</span> MD
</code></pre></div>


<span class="katex">
  \[
p_{2} = 4 l_{1} l_{2} u_{6} + 4 l_{1} l_{3} u_{5} + l_{1} u_{1} \left(2 l_{1} - 1\right) + 4 l_{2} l_{3} u_{4} + l_{2} u_{2} \left(2 l_{2} - 1\right) + l_{3} u_{3} \left(2 l_{3} - 1\right)
\]
</span>

<h2 id="三次多项式插值">三次多项式插值</h2>



<span class="katex">
  \[
p_3(l_1,l_2,l_3)=c_1 l_1^3 + c_2 l_2^3   + c_3 l_3^3  + c_4 l_1^2 l_2 + c_5 l_1^2 l_3 + c_6 l_2^2 l_1 + c_7 l_2^2 l_3  + c_8 l_3^2 l_1 + c_9 l_3^2 l_2 + c10 l_1 l_2 l_3
\]
</span>

<p>这有10个待定系数，1中心点，3个顶点，每个顶点还有2个偏导数，恰好可建10个方程。</p>
<p>由于涉及偏导数，所以要先给出偏导数函数<code>dpx(r,s,t)</code>和<code>dpy(r,s,t)</code>（见后面的代码）。</p>
<p>据此可解出这10个待定系数,进而可写出用面积坐标表示的三次多项式插值：</p>



<span class="katex">
  \[
\boxed{\color{red}{\left\{\begin{aligned}p_3(l_1,l_2,l_3) &= \alpha_0 u_{10} + \sum^3_{i=1}{\left[\alpha_i u_i+\beta_i u_{3+i}+\gamma_i u_{6+i}\right]}\\ \alpha_0 &= 27 l_1 l_2 l_3 \\ \alpha_i &=l_i^3+3 l_i^2(l_j-l_k)-7 l_1,l_2,l_3  \\ \beta_i &= (x_j-x_i)(l_i^2 l_j-l_1 l_2 l_3)+(x_k-x_i)(l_i^2 l_k-l_1 l_2 l_3) \\ \gamma_i &= (y_j-y_i)(l_i^2 l_j-l_1 l_2 l_3)+(y_k-y_i)(l_i^2 l_k-l_1 l_2 l_3) \end{aligned}\right.}} \\ l_{3+i}=l_i,\qquad j=i+1,k=i+2
\]
</span>

<p>其中，


<span class="katex">
  \(u_{10}\)
</span>
对应中点值，


<span class="katex">
  \(u_1,u_2,u_3\)
</span>
对应3个顶点值，


<span class="katex">
  \(u_4,u_5,u_6\)
</span>
对应3个顶点沿


<span class="katex">
  \(x\)
</span>
偏导数值，


<span class="katex">
  \(u_7,u_8,u_9\)
</span>
对应3个顶点沿


<span class="katex">
  \(y\)
</span>
偏导数值</p>
<p>推导如下（保存在变量<code>pl3</code>中，对应的系数保持在数组<code>αβγ</code>中）：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia"><span style="color:#75715e"># 10个节点值</span>
U <span style="color:#f92672">=</span> [symbols(<span style="color:#e6db74">&#34;u</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>, real<span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>]
<span style="color:#75715e"># 10个待定系数</span>
C <span style="color:#f92672">=</span> [symbols(<span style="color:#e6db74">&#34;c</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>, real<span style="color:#f92672">=</span><span style="color:#66d9ef">true</span>) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>]

<span style="color:#75715e"># 三次多项式插值（有待定系数）</span>
p3(r,s,t)<span style="color:#f92672">=</span>C[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">*</span>r<span style="color:#f92672">^</span><span style="color:#ae81ff">3</span><span style="color:#f92672">+</span>C[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">*</span>s<span style="color:#f92672">^</span><span style="color:#ae81ff">3</span><span style="color:#f92672">+</span>C[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">*</span>t<span style="color:#f92672">^</span><span style="color:#ae81ff">3</span><span style="color:#f92672">+</span>C[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">*</span>r<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>s<span style="color:#f92672">+</span>C[<span style="color:#ae81ff">5</span>]<span style="color:#f92672">*</span>r<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>t<span style="color:#f92672">+</span>C[<span style="color:#ae81ff">6</span>]<span style="color:#f92672">*</span>s<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>r<span style="color:#f92672">+</span>C[<span style="color:#ae81ff">7</span>]<span style="color:#f92672">*</span>s<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>t<span style="color:#f92672">+</span>C[<span style="color:#ae81ff">8</span>]<span style="color:#f92672">*</span>t<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>r<span style="color:#f92672">+</span>C[<span style="color:#ae81ff">9</span>]<span style="color:#f92672">*</span>t<span style="color:#f92672">^</span><span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>s<span style="color:#f92672">+</span>C[<span style="color:#ae81ff">10</span>]<span style="color:#f92672">*</span>r<span style="color:#f92672">*</span>s<span style="color:#f92672">*</span>t
<span style="color:#75715e"># 偏导数函数</span>
ex <span style="color:#f92672">=</span> p3(L[<span style="color:#ae81ff">1</span>],L[<span style="color:#ae81ff">2</span>],L[<span style="color:#ae81ff">3</span>])
ex1 <span style="color:#f92672">=</span> sum(diff(ex,L[i])<span style="color:#f92672">*</span>diff(LL[i],x) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>) <span style="color:#f92672">|&gt;</span>  simplify
ex2 <span style="color:#f92672">=</span> sum(diff(ex,L[i])<span style="color:#f92672">*</span>diff(LL[i],y) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>) <span style="color:#f92672">|&gt;</span>  simplify
dpx(r,s,t)<span style="color:#f92672">=</span>ex1(L[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=&gt;</span>r,L[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">=&gt;</span>s,L[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">=&gt;</span>t)
dpy(r,s,t)<span style="color:#f92672">=</span>ex2(L[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=&gt;</span>r,L[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">=&gt;</span>s,L[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">=&gt;</span>t);

<span style="color:#75715e"># 3个顶点面积坐标</span>
M<span style="color:#f92672">=</span> [LL[j](x<span style="color:#f92672">=&gt;</span>X[i],y<span style="color:#f92672">=&gt;</span>Y[i]) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>, j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>] <span style="color:#f92672">.|&gt;</span>  simplify

<span style="color:#75715e"># 3个顶点方程</span>
eqs <span style="color:#f92672">=</span> [ p3(M[i,<span style="color:#ae81ff">1</span>],M[i,<span style="color:#ae81ff">2</span>],M[i,<span style="color:#ae81ff">3</span>])⩵U[i] <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]

<span style="color:#75715e"># 6个偏导数方程</span>
eqs <span style="color:#f92672">=</span> vcat(eqs,[dpx(M[i,<span style="color:#ae81ff">1</span>],M[i,<span style="color:#ae81ff">2</span>],M[i,<span style="color:#ae81ff">3</span>])⩵U[<span style="color:#ae81ff">3</span><span style="color:#f92672">+</span>i] <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>])
eqs <span style="color:#f92672">=</span> vcat(eqs,[dpy(M[i,<span style="color:#ae81ff">1</span>],M[i,<span style="color:#ae81ff">2</span>],M[i,<span style="color:#ae81ff">3</span>])⩵U[<span style="color:#ae81ff">6</span><span style="color:#f92672">+</span>i] <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>])

<span style="color:#75715e"># 1个中点方程</span>
eqs <span style="color:#f92672">=</span> vcat(eqs,[p3(sum(M[<span style="color:#f92672">:</span>,<span style="color:#ae81ff">1</span>])<span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>,sum(M[<span style="color:#f92672">:</span>,<span style="color:#ae81ff">2</span>])<span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>,sum(M[<span style="color:#f92672">:</span>,<span style="color:#ae81ff">3</span>])<span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>)⩵U[<span style="color:#ae81ff">10</span>]])

<span style="color:#75715e"># 解出待定系数</span>
<span style="color:#a6e22e">@time</span> solC <span style="color:#f92672">=</span> solve(eqs,C)

<span style="color:#75715e"># 三次多项式插值（结果）</span>
pl3 <span style="color:#f92672">=</span> p3(L[<span style="color:#ae81ff">1</span>],L[<span style="color:#ae81ff">2</span>],L[<span style="color:#ae81ff">3</span>])(solC)
pl3 <span style="color:#f92672">=</span> collect(pl3 <span style="color:#f92672">|&gt;</span> expand, U) 

<span style="color:#75715e"># 列出u1,...,u10的系数</span>
<span style="color:#75715e"># αβγ[10]对应α0</span>
<span style="color:#75715e"># αβγ[1:3]对应α1,α2,α3</span>
<span style="color:#75715e"># αβγ[4:6]对应β1,β2,β3</span>
<span style="color:#75715e"># αβγ[7:9]对应γ1,γ2,γ3</span>
αβγ <span style="color:#f92672">=</span> [diff(pl3,U[i]) <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">10</span>]

<span style="color:#75715e"># 尽可能对每个系数合并同类项</span>
ls <span style="color:#f92672">=</span> [L[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">^</span>i<span style="color:#f92672">*</span>L[<span style="color:#ae81ff">2</span>]<span style="color:#f92672">^</span>j<span style="color:#f92672">*</span>L[<span style="color:#ae81ff">3</span>]<span style="color:#f92672">^</span>k <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>, j <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>, k <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span> <span style="color:#66d9ef">if</span> i<span style="color:#f92672">+</span>j<span style="color:#f92672">+</span>k<span style="color:#f92672">==</span><span style="color:#ae81ff">3</span>]
αβγ <span style="color:#f92672">=</span> αβγ <span style="color:#f92672">.|&gt;</span>  t<span style="color:#f92672">-&gt;</span>collect(t, ls) 

<span style="color:#75715e"># 显示</span>
tmp <span style="color:#f92672">=</span> [symbols(<span style="color:#e6db74">&#34;α0&#34;</span>)⩵αβγ[<span style="color:#ae81ff">10</span>]] 
tmp <span style="color:#f92672">=</span> vcat(tmp,[symbols(<span style="color:#e6db74">&#34;α</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>)⩵αβγ[i] <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>])
tmp <span style="color:#f92672">=</span> vcat(tmp,[symbols(<span style="color:#e6db74">&#34;β</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>)⩵αβγ[<span style="color:#ae81ff">3</span><span style="color:#f92672">+</span>i] <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>])
tmp <span style="color:#f92672">=</span> vcat(tmp,[symbols(<span style="color:#e6db74">&#34;γ</span><span style="color:#e6db74">$i</span><span style="color:#e6db74">&#34;</span>)⩵αβγ[<span style="color:#ae81ff">6</span><span style="color:#f92672">+</span>i] <span style="color:#66d9ef">for</span> i <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>])
tmp <span style="color:#f92672">.|&gt;</span> latex <span style="color:#f92672">|&gt;</span> MD
</code></pre></div><pre><code> 15.244530 seconds (597 allocations: 18.047 KiB)
</code></pre>



<span class="katex">
  \[
α0 = 27 l_{1} l_{2} l_{3}
\]
</span>




<span class="katex">
  \[
α1 = l_{1}^{3} + 3 l_{1}^{2} l_{2} + 3 l_{1}^{2} l_{3} - 7 l_{1} l_{2} l_{3}
\]
</span>




<span class="katex">
  \[
α2 = 3 l_{1} l_{2}^{2} - 7 l_{1} l_{2} l_{3} + l_{2}^{3} + 3 l_{2}^{2} l_{3}
\]
</span>




<span class="katex">
  \[
α3 = - 7 l_{1} l_{2} l_{3} + 3 l_{1} l_{3}^{2} + 3 l_{2} l_{3}^{2} + l_{3}^{3}
\]
</span>




<span class="katex">
  \[
β1 = l_{1}^{2} l_{2} \left(- x_{1} + x_{2}\right) + l_{1}^{2} l_{3} \left(- x_{1} + x_{3}\right) + l_{1} l_{2} l_{3} \left(2 x_{1} - x_{2} - x_{3}\right)
\]
</span>




<span class="katex">
  \[
β2 = l_{1} l_{2}^{2} \left(x_{1} - x_{2}\right) + l_{1} l_{2} l_{3} \left(- x_{1} + 2 x_{2} - x_{3}\right) + l_{2}^{2} l_{3} \left(- x_{2} + x_{3}\right)
\]
</span>




<span class="katex">
  \[
β3 = l_{1} l_{2} l_{3} \left(- x_{1} - x_{2} + 2 x_{3}\right) + l_{1} l_{3}^{2} \left(x_{1} - x_{3}\right) + l_{2} l_{3}^{2} \left(x_{2} - x_{3}\right)
\]
</span>




<span class="katex">
  \[
γ1 = l_{1}^{2} l_{2} \left(- y_{1} + y_{2}\right) + l_{1}^{2} l_{3} \left(- y_{1} + y_{3}\right) + l_{1} l_{2} l_{3} \left(2 y_{1} - y_{2} - y_{3}\right)
\]
</span>




<span class="katex">
  \[
γ2 = l_{1} l_{2}^{2} \left(y_{1} - y_{2}\right) + l_{1} l_{2} l_{3} \left(- y_{1} + 2 y_{2} - y_{3}\right) + l_{2}^{2} l_{3} \left(- y_{2} + y_{3}\right)
\]
</span>




<span class="katex">
  \[
γ3 = l_{1} l_{2} l_{3} \left(- y_{1} - y_{2} + 2 y_{3}\right) + l_{1} l_{3}^{2} \left(y_{1} - y_{3}\right) + l_{2} l_{3}^{2} \left(y_{2} - y_{3}\right)
\]
</span></article>

<hr>

<nav class="post-pagination">
  
  <a class="newer-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0093/">
    下一页<br>有限元之Delaunay三角剖分
  </a>
  
  
  
  <a class="older-posts" href="https://chaoskey.gitee.io/notes/docs/julia/0091/">
      上一页<br>有限元法解常微分方程边值问题
  </a>
  
</nav>

 

      <footer class="book-footer">
        
  <div class="flex justify-between">





  <div>
    <a class="flex align-center" href="https://gitee.com/chaoskey/notes/blob/master/content/docs/julia/0092.md#blob-comment" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Comment" />
      <span>评论</span>
    </a>
  </div>
  
  
  <div>
    <a class="flex align-center" href="https://gitee.com/-/ide/project/chaoskey/notes/edit/master/-/content/docs/julia/0092.md" target="_blank" rel="noopener">
      <img src="/notes/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>编辑本页</span>
    </a>
  </div>

</div>

 
        
  
  <div class="book-comments">

</div>
  
  
      </footer>
      
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#三角单元内点的面积坐标">三角单元内点的面积坐标</a></li>
    <li><a href="#三角元上的多项式插值">三角元上的多项式插值</a>
      <ul>
        <li><a href="#一次多项式插值">一次多项式插值</a></li>
        <li><a href="#二次多项式插值">二次多项式插值</a></li>
        <li><a href="#三次多项式插值">三次多项式插值</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












